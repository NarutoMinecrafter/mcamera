!function(){"use strict";var e={9657:function(e,t,n){n.d(t,{z9:function(){return k},VK:function(){return i},NY:function(){return m},IG:function(){return y},d_:function(){return A},WL:function(){return p},jq:function(){return x},Gz:function(){return v},_Q:function(){return S},QC:function(){return P},iW:function(){return M}});const r="http://localhost:3000".replace(/\/+$/,"");class o{constructor(e=new i){this.configuration=e,this.fetchApi=async(e,t)=>{let n={url:e,init:t};for(const e of this.middleware)e.pre&&(n=await e.pre({fetch:this.fetchApi,...n})||n);let r=await this.configuration.fetchApi(n.url,n.init);for(const n of this.middleware)n.post&&(r=await n.post({fetch:this.fetchApi,url:e,init:t,response:r.clone()})||r);return r},this.middleware=e.middleware}withMiddleware(...e){const t=this.clone();return t.middleware=t.middleware.concat(...e),t}withPreMiddleware(...e){const t=e.map((e=>({pre:e})));return this.withMiddleware(...t)}withPostMiddleware(...e){const t=e.map((e=>({post:e})));return this.withMiddleware(...t)}async request(e){const{url:t,init:n}=this.createFetchParams(e),r=await this.fetchApi(t,n);if(r.status>=200&&r.status<300)return r;throw r}createFetchParams(e){let t=this.configuration.basePath+e.path;void 0!==e.query&&0!==Object.keys(e.query).length&&(t+="?"+this.configuration.queryParamsStringify(e.query));const n="undefined"!=typeof FormData&&e.body instanceof FormData||e.body instanceof URLSearchParams||(r=e.body,"undefined"!=typeof Blob&&r instanceof Blob)?e.body:JSON.stringify(e.body);var r;const o=Object.assign({},this.configuration.headers,e.headers);return{url:t,init:{method:e.method,headers:o,body:n,credentials:this.configuration.credentials}}}clone(){const e=new(0,this.constructor)(this.configuration);return e.middleware=this.middleware.slice(),e}}class a extends Error{constructor(e,t){super(t),this.field=e,this.name="RequiredError"}}class i{constructor(e={}){this.configuration=e}get basePath(){return null!=this.configuration.basePath?this.configuration.basePath:r}get fetchApi(){return this.configuration.fetchApi||window.fetch.bind(window)}get middleware(){return this.configuration.middleware||[]}get queryParamsStringify(){return this.configuration.queryParamsStringify||s}get username(){return this.configuration.username}get password(){return this.configuration.password}get apiKey(){const e=this.configuration.apiKey;if(e)return"function"==typeof e?e:()=>e}get accessToken(){const e=this.configuration.accessToken;if(e)return"function"==typeof e?e:()=>e}get headers(){return this.configuration.headers}get credentials(){return this.configuration.credentials}}function s(e,t=""){return Object.keys(e).map((n=>{const r=t+(t.length?`[${n}]`:n),o=e[n];if(o instanceof Array){const e=o.map((e=>encodeURIComponent(String(e)))).join(`&${encodeURIComponent(r)}=`);return`${encodeURIComponent(r)}=${e}`}return o instanceof Object?s(o,r):`${encodeURIComponent(r)}=${encodeURIComponent(String(o))}`})).filter((e=>e.length>0)).join("&")}class l{constructor(e,t=(e=>e)){this.raw=e,this.transformer=t}async value(){return this.transformer(await this.raw.json())}}class c{constructor(e){this.raw=e}async value(){}}function d(e){if(void 0!==e)return null===e?null:{username:e.username,password:e.password,isAdmin:e.isAdmin}}function u(e){if(void 0!==e)return null===e?null:{identifier:e.identifier,name:e.name,randomSymbols:e.randomSymbols,scheduleFrequencyPhoto:e.scheduleFrequencyPhoto,scheduleDurationPhoto:e.scheduleDurationPhoto,scheduleFramesQuantity:e.scheduleFramesQuantity,movementCells:e.movementCells,movementDiffLevel:e.movementDiffLevel,movementChangeFrameTime:e.movementChangeFrameTime,movementFrequencyAnalyzing:e.movementFrequencyAnalyzing,circleDurationBeforeMoveSensor:e.circleDurationBeforeMoveSensor,circleFramesQuantityBeforeMove:e.circleFramesQuantityBeforeMove,circleDurationDuringMoveSensorUnit:e.circleDurationDuringMoveSensorUnit,circleDurationDuringMoveSensor:e.circleDurationDuringMoveSensor,circleFramesQuantityDuringMove:e.circleFramesQuantityDuringMove,circleDurationAfterMoveSensor:e.circleDurationAfterMoveSensor,circleFramesQuantityAfterMove:e.circleFramesQuantityAfterMove}}var m,h,p,v,f;function g(e){if(void 0!==e)return null===e?null:{addDevice:e.addDevice,removeDevice:e.removeDevice,editDevice:e.editDevice,download:e.download,removePhoto:e.removePhoto}}function w(e){return y(e)}function y(e,t){return null==e?e:{id:e.id,identifier:e.identifier,name:e.name,battery:e.battery,randomSymbols:e.randomSymbols,scheduleFrequencyPhoto:e.scheduleFrequencyPhoto,scheduleDurationPhoto:e.scheduleDurationPhoto,scheduleFramesQuantity:e.scheduleFramesQuantity,movementCells:e.movementCells,movementDiffLevel:e.movementDiffLevel,movementChangeFrameTime:e.movementChangeFrameTime,movementFrequencyAnalyzing:e.movementFrequencyAnalyzing,circleDurationBeforeMoveSensor:e.circleDurationBeforeMoveSensor,circleFramesQuantityBeforeMove:e.circleFramesQuantityBeforeMove,circleDurationDuringMoveSensorUnit:e.circleDurationDuringMoveSensorUnit,circleDurationDuringMoveSensor:e.circleDurationDuringMoveSensor,circleFramesQuantityDuringMove:e.circleFramesQuantityDuringMove,circleDurationAfterMoveSensor:e.circleDurationAfterMoveSensor,circleFramesQuantityAfterMove:e.circleFramesQuantityAfterMove,userGroups:Z(e.userGroups),userGroupsId:e.userGroupsId,packet:C(e.packet),photo:b(e.photo)}}function C(e){return function(e,t){return null==e?e:{id:e.id,status:e.status,device:w(e.device),deviceId:e.deviceId,lastPacketTime:new Date(e.lastPacketTime)}}(e)}function E(e){return function(e,t){return null==e?e:{id:e.id,addDevice:e.addDevice,removeDevice:e.removeDevice,editDevice:e.editDevice,download:e.download,removePhoto:e.removePhoto,user:I(e.user),userId:e.userId}}(e)}function b(e){return function(e,t){return null==e?e:{id:e.id,originalName:e.originalName,originaltime:e.originaltime,name:e.name,path:e.path,type:e.type,createDateTime:new Date(e.createDateTime),source:e.source,device:w(e.device),deviceId:e.deviceId}}(e)}function D(e){if(void 0!==e)return null===e?null:{ids:e.ids}}function I(e){return function(e,t){return null==e?e:{id:e.id,username:e.username,password:e.password,isAdmin:e.isAdmin,salt:e.salt,permission:E(e.permission),userGroups:Z(e.userGroups),userGroupsId:e.userGroupsId}}(e)}function Z(e){return function(e,t){return null==e?e:{id:e.id,users:e.users.map(I),devices:e.devices.map(w)}}(e)}!function(e){e.Seconds="Seconds",e.Minutes="Minutes"}(m||(m={})),function(e){e.Seconds="Seconds",e.Minutes="Minutes"}(h||(h={})),function(e){e.TOSEND="TO_SEND",e.SENDING="SENDING",e.NONE="NONE"}(p||(p={})),function(e){e.BM="BM",e.MD="MD",e.EoM="EoM",e.Sch="Sch"}(v||(v={}));class k extends o{async authControllerSignInRaw(e){if(null===e.authCredentialsDto||void 0===e.authCredentialsDto)throw new a("authCredentialsDto","Required parameter requestParameters.authCredentialsDto was null or undefined when calling authControllerSignIn.");const t=await this.request({path:"/auth/signin",method:"POST",headers:{"Content-Type":"application/json"},query:{},body:d(e.authCredentialsDto)});return new l(t,(e=>function(e,t){return null==e?e:{accesstoken:e.accesstoken}}(e)))}async authControllerSignIn(e){const t=await this.authControllerSignInRaw(e);return await t.value()}async authControllerSignUpRaw(e){if(null===e.userGroupId||void 0===e.userGroupId)throw new a("userGroupId","Required parameter requestParameters.userGroupId was null or undefined when calling authControllerSignUp.");if(null===e.authCredentialsDto||void 0===e.authCredentialsDto)throw new a("authCredentialsDto","Required parameter requestParameters.authCredentialsDto was null or undefined when calling authControllerSignUp.");const t={"Content-Type":"application/json"};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/auth/signup/{userGroupId}".replace("{userGroupId}",encodeURIComponent(String(e.userGroupId))),method:"POST",headers:t,query:{},body:d(e.authCredentialsDto)});return new c(n)}async authControllerSignUp(e){await this.authControllerSignUpRaw(e)}}class A extends o{async devicesControllerCreateDeviceRaw(e){if(null===e.createDeviceDto||void 0===e.createDeviceDto)throw new a("createDeviceDto","Required parameter requestParameters.createDeviceDto was null or undefined when calling devicesControllerCreateDevice.");const t={"Content-Type":"application/json"};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/devices",method:"POST",headers:t,query:{},body:u(e.createDeviceDto)});return new l(n,(e=>w(e)))}async devicesControllerCreateDevice(e){const t=await this.devicesControllerCreateDeviceRaw(e);return await t.value()}async devicesControllerCreateDeviceAdminRaw(e){if(null===e.userId||void 0===e.userId)throw new a("userId","Required parameter requestParameters.userId was null or undefined when calling devicesControllerCreateDeviceAdmin.");if(null===e.createDeviceDto||void 0===e.createDeviceDto)throw new a("createDeviceDto","Required parameter requestParameters.createDeviceDto was null or undefined when calling devicesControllerCreateDeviceAdmin.");const t={"Content-Type":"application/json"};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/devices/admin/{userId}".replace("{userId}",encodeURIComponent(String(e.userId))),method:"POST",headers:t,query:{},body:u(e.createDeviceDto)});return new l(n,(e=>w(e)))}async devicesControllerCreateDeviceAdmin(e){const t=await this.devicesControllerCreateDeviceAdminRaw(e);return await t.value()}async devicesControllerDeleteDeviceRaw(e){if(null===e.id||void 0===e.id)throw new a("id","Required parameter requestParameters.id was null or undefined when calling devicesControllerDeleteDevice.");const t={};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/devices/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"DELETE",headers:t,query:{}});return new c(n)}async devicesControllerDeleteDevice(e){await this.devicesControllerDeleteDeviceRaw(e)}async devicesControllerGetDeviceByIdRaw(e){if(null===e.id||void 0===e.id)throw new a("id","Required parameter requestParameters.id was null or undefined when calling devicesControllerGetDeviceById.");const t={};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/devices/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"GET",headers:t,query:{}});return new l(n,(e=>w(e)))}async devicesControllerGetDeviceById(e){const t=await this.devicesControllerGetDeviceByIdRaw(e);return await t.value()}async devicesControllerGetUserDevicesRaw(){const e={};if(this.configuration&&this.configuration.accessToken){const t=this.configuration.accessToken,n="function"==typeof t?t("bearer",[]):t;n&&(e.Authorization=`Bearer ${n}`)}const t=await this.request({path:"/devices",method:"GET",headers:e,query:{}});return new l(t,(e=>e.map(w)))}async devicesControllerGetUserDevices(){const e=await this.devicesControllerGetUserDevicesRaw();return await e.value()}async devicesControllerRemoveDeviceAdminRaw(e){if(null===e.userId||void 0===e.userId)throw new a("userId","Required parameter requestParameters.userId was null or undefined when calling devicesControllerRemoveDeviceAdmin.");if(null===e.deviceId||void 0===e.deviceId)throw new a("deviceId","Required parameter requestParameters.deviceId was null or undefined when calling devicesControllerRemoveDeviceAdmin.");const t={};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/devices/admin/{userId}/{deviceId}".replace("{userId}",encodeURIComponent(String(e.userId))).replace("{deviceId}",encodeURIComponent(String(e.deviceId))),method:"DELETE",headers:t,query:{}});return new c(n)}async devicesControllerRemoveDeviceAdmin(e){await this.devicesControllerRemoveDeviceAdminRaw(e)}async devicesControllerUpdateDeviceRaw(e){if(null===e.id||void 0===e.id)throw new a("id","Required parameter requestParameters.id was null or undefined when calling devicesControllerUpdateDevice.");if(null===e.createDeviceDto||void 0===e.createDeviceDto)throw new a("createDeviceDto","Required parameter requestParameters.createDeviceDto was null or undefined when calling devicesControllerUpdateDevice.");const t={"Content-Type":"application/json"};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/devices/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"PATCH",headers:t,query:{},body:u(e.createDeviceDto)});return new l(n,(e=>w(e)))}async devicesControllerUpdateDevice(e){const t=await this.devicesControllerUpdateDeviceRaw(e);return await t.value()}async devicesControllerUpdateDeviceAdminRaw(e){if(null===e.userId||void 0===e.userId)throw new a("userId","Required parameter requestParameters.userId was null or undefined when calling devicesControllerUpdateDeviceAdmin.");if(null===e.deviceId||void 0===e.deviceId)throw new a("deviceId","Required parameter requestParameters.deviceId was null or undefined when calling devicesControllerUpdateDeviceAdmin.");if(null===e.createDeviceDto||void 0===e.createDeviceDto)throw new a("createDeviceDto","Required parameter requestParameters.createDeviceDto was null or undefined when calling devicesControllerUpdateDeviceAdmin.");const t={"Content-Type":"application/json"};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/devices/admin/{userId}/{deviceId}".replace("{userId}",encodeURIComponent(String(e.userId))).replace("{deviceId}",encodeURIComponent(String(e.deviceId))),method:"POST",headers:t,query:{},body:u(e.createDeviceDto)});return new l(n,(e=>w(e)))}async devicesControllerUpdateDeviceAdmin(e){const t=await this.devicesControllerUpdateDeviceAdminRaw(e);return await t.value()}}!function(e){e.BM="BM",e.MD="MD",e.EoM="EoM",e.Sch="Sch"}(f||(f={}));class x extends o{async permissionsControllerGetUserPermissionsRaw(){const e={};if(this.configuration&&this.configuration.accessToken){const t=this.configuration.accessToken,n="function"==typeof t?t("bearer",[]):t;n&&(e.Authorization=`Bearer ${n}`)}const t=await this.request({path:"/permissions",method:"GET",headers:e,query:{}});return new l(t,(e=>E(e)))}async permissionsControllerGetUserPermissions(){const e=await this.permissionsControllerGetUserPermissionsRaw();return await e.value()}async permissionsControllerUpdatePermissionsRaw(e){if(null===e.userId||void 0===e.userId)throw new a("userId","Required parameter requestParameters.userId was null or undefined when calling permissionsControllerUpdatePermissions.");if(null===e.createPermissionDto||void 0===e.createPermissionDto)throw new a("createPermissionDto","Required parameter requestParameters.createPermissionDto was null or undefined when calling permissionsControllerUpdatePermissions.");const t={"Content-Type":"application/json"};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/permissions/{userId}".replace("{userId}",encodeURIComponent(String(e.userId))),method:"POST",headers:t,query:{},body:g(e.createPermissionDto)});return new l(n,(e=>E(e)))}async permissionsControllerUpdatePermissions(e){const t=await this.permissionsControllerUpdatePermissionsRaw(e);return await t.value()}}class S extends o{async photosControllerDownloadPhotoByPathRaw(e){if(null===e.imageName||void 0===e.imageName)throw new a("imageName","Required parameter requestParameters.imageName was null or undefined when calling photosControllerDownloadPhotoByPath.");const t=await this.request({path:"/photos/download/{imageName}".replace("{imageName}",encodeURIComponent(String(e.imageName))),method:"GET",headers:{},query:{}});return new c(t)}async photosControllerDownloadPhotoByPath(e){await this.photosControllerDownloadPhotoByPathRaw(e)}async photosControllerGetLastPhotoRaw(e){if(null===e.deviceId||void 0===e.deviceId)throw new a("deviceId","Required parameter requestParameters.deviceId was null or undefined when calling photosControllerGetLastPhoto.");const t={};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/photos/getLastPhoto/{deviceId}".replace("{deviceId}",encodeURIComponent(String(e.deviceId))),method:"GET",headers:t,query:{}});return new l(n,(e=>b(e)))}async photosControllerGetLastPhoto(e){const t=await this.photosControllerGetLastPhotoRaw(e);return await t.value()}async photosControllerGetPhotoByPathRaw(e){if(null===e.imageName||void 0===e.imageName)throw new a("imageName","Required parameter requestParameters.imageName was null or undefined when calling photosControllerGetPhotoByPath.");const t=await this.request({path:"/photos/preview/{imageName}".replace("{imageName}",encodeURIComponent(String(e.imageName))),method:"GET",headers:{},query:{}});return new c(t)}async photosControllerGetPhotoByPath(e){await this.photosControllerGetPhotoByPathRaw(e)}async photosControllerGetPhotosByIdRaw(e){if(null===e.deviceId||void 0===e.deviceId)throw new a("deviceId","Required parameter requestParameters.deviceId was null or undefined when calling photosControllerGetPhotosById.");if(null===e.start||void 0===e.start)throw new a("start","Required parameter requestParameters.start was null or undefined when calling photosControllerGetPhotosById.");if(null===e.end||void 0===e.end)throw new a("end","Required parameter requestParameters.end was null or undefined when calling photosControllerGetPhotosById.");const t={};void 0!==e.start&&(t.start=e.start),void 0!==e.end&&(t.end=e.end);const n={};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,t="function"==typeof e?e("bearer",[]):e;t&&(n.Authorization=`Bearer ${t}`)}const r=await this.request({path:"/photos/{deviceId}".replace("{deviceId}",encodeURIComponent(String(e.deviceId))),method:"GET",headers:n,query:t});return new l(r,(e=>e.map(b)))}async photosControllerGetPhotosById(e){const t=await this.photosControllerGetPhotosByIdRaw(e);return await t.value()}async photosControllerRemovePhotoByIdRaw(e){if(null===e.id||void 0===e.id)throw new a("id","Required parameter requestParameters.id was null or undefined when calling photosControllerRemovePhotoById.");const t={};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/photos/{id}".replace("{id}",encodeURIComponent(String(e.id))),method:"DELETE",headers:t,query:{}});return new c(n)}async photosControllerRemovePhotoById(e){await this.photosControllerRemovePhotoByIdRaw(e)}async photosControllerRemovePhotosByIdRaw(e){if(null===e.removePhotosDto||void 0===e.removePhotosDto)throw new a("removePhotosDto","Required parameter requestParameters.removePhotosDto was null or undefined when calling photosControllerRemovePhotosById.");const t={"Content-Type":"application/json"};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/photos/removeBatch",method:"POST",headers:t,query:{},body:D(e.removePhotosDto)});return new c(n)}async photosControllerRemovePhotosById(e){await this.photosControllerRemovePhotosByIdRaw(e)}}class P extends o{async userGroupsControllerCreateUserGroupRaw(){const e={};if(this.configuration&&this.configuration.accessToken){const t=this.configuration.accessToken,n="function"==typeof t?t("bearer",[]):t;n&&(e.Authorization=`Bearer ${n}`)}const t=await this.request({path:"/userGroup/admin",method:"POST",headers:e,query:{}});return new l(t,(e=>Z(e)))}async userGroupsControllerCreateUserGroup(){const e=await this.userGroupsControllerCreateUserGroupRaw();return await e.value()}async userGroupsControllerDeleteUserGroupRaw(e){if(null===e.userGroupId||void 0===e.userGroupId)throw new a("userGroupId","Required parameter requestParameters.userGroupId was null or undefined when calling userGroupsControllerDeleteUserGroup.");const t={};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/userGroup/admin/{userGroupId}".replace("{userGroupId}",encodeURIComponent(String(e.userGroupId))),method:"DELETE",headers:t,query:{}});return new c(n)}async userGroupsControllerDeleteUserGroup(e){await this.userGroupsControllerDeleteUserGroupRaw(e)}async userGroupsControllerGetUserGroupsRaw(){const e={};if(this.configuration&&this.configuration.accessToken){const t=this.configuration.accessToken,n="function"==typeof t?t("bearer",[]):t;n&&(e.Authorization=`Bearer ${n}`)}const t=await this.request({path:"/userGroup/admin",method:"GET",headers:e,query:{}});return new l(t,(e=>e.map(Z)))}async userGroupsControllerGetUserGroups(){const e=await this.userGroupsControllerGetUserGroupsRaw();return await e.value()}}class M extends o{async usersControllerEditUserRaw(e){if(null===e.userId||void 0===e.userId)throw new a("userId","Required parameter requestParameters.userId was null or undefined when calling usersControllerEditUser.");if(null===e.authCredentialsDto||void 0===e.authCredentialsDto)throw new a("authCredentialsDto","Required parameter requestParameters.authCredentialsDto was null or undefined when calling usersControllerEditUser.");const t={"Content-Type":"application/json"};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/admin/users/{userId}".replace("{userId}",encodeURIComponent(String(e.userId))),method:"POST",headers:t,query:{},body:d(e.authCredentialsDto)});return new l(n,(e=>I(e)))}async usersControllerEditUser(e){const t=await this.usersControllerEditUserRaw(e);return await t.value()}async usersControllerGetUsersWithDevicesRaw(){const e={};if(this.configuration&&this.configuration.accessToken){const t=this.configuration.accessToken,n="function"==typeof t?t("bearer",[]):t;n&&(e.Authorization=`Bearer ${n}`)}const t=await this.request({path:"/admin/users",method:"GET",headers:e,query:{}});return new l(t,(e=>e.map(I)))}async usersControllerGetUsersWithDevices(){const e=await this.usersControllerGetUsersWithDevicesRaw();return await e.value()}async usersControllerRemoveUserRaw(e){if(null===e.userId||void 0===e.userId)throw new a("userId","Required parameter requestParameters.userId was null or undefined when calling usersControllerRemoveUser.");const t={};if(this.configuration&&this.configuration.accessToken){const e=this.configuration.accessToken,n="function"==typeof e?e("bearer",[]):e;n&&(t.Authorization=`Bearer ${n}`)}const n=await this.request({path:"/admin/users/{userId}".replace("{userId}",encodeURIComponent(String(e.userId))),method:"DELETE",headers:t,query:{}});return new c(n)}async usersControllerRemoveUser(e){await this.usersControllerRemoveUserRaw(e)}}},9933:function(e,t,n){n.d(t,{Z:function(){return ur}});var r=n(7294),o=n(5977),a=n(1579),i=n(2132),s=(n(5202),n(5834)),l=n(3901),c=n(282),d=n(8286),u=n(553),m=n(3258),h=n(2267),p=n(2318),v=n(3832),f=n(1120);const g=(0,f.Z)((e=>({paper:{marginTop:e.spacing(8),display:"flex",flexDirection:"column",alignItems:"center"},avatar:{margin:e.spacing(1),backgroundColor:e.palette.secondary.main},form:{width:"100%",marginTop:e.spacing(1)},submit:{margin:e.spacing(3,0,2)}})));var w=n(9657),y=n(670);const C="ACCESS_TOKEN_MVD_UI",E=()=>(0,y.get)(C)||"",b=()=>(0,y.remove)(C);var D=n(5659),I=n(4751),Z=n(7503);const k=e=>async t=>{401===t.response.status&&(b(),e(Z.l.actions.setCurrentUser(null)))};var A=n(5871);const x=new w.QC(new w.VK({accessToken:E,basePath:(0,D.b)()})),S=()=>{const e=(0,I.I0)();return{getUserGroups:(0,r.useCallback)((()=>(async()=>{try{const t=await x.withPostMiddleware(k(e)).userGroupsControllerGetUserGroups();e(A.N.actions.usersGroupsReceived(t))}catch(e){i.Am.error(e.statusText)}})()),[]),removeUserGroup:(0,r.useCallback)((t=>(async()=>{try{await x.withPostMiddleware(k(e)).userGroupsControllerDeleteUserGroup({userGroupId:t}),e(A.N.actions.removeUserGroup(t))}catch(e){i.Am.error(e.statusText)}})()),[])}};var P=n(9901);const M=new w.z9(new w.VK({accessToken:E,basePath:(0,D.b)()})),T=(e="")=>{const t=(0,o.k6)(),n=(0,I.I0)();return{signin:async e=>{try{const{accesstoken:r}=await M.authControllerSignIn({authCredentialsDto:e});n=r,(0,y.set)(C,n),t.push("/")}catch(e){const t=await e.json();i.Am.error(t.message)}var n},signup:async t=>{let r=+(e||0);try{if(!r){const e=await x.withPostMiddleware(k(n)).userGroupsControllerCreateUserGroup();n(P.Nn.actions.userGroupsAdded(e)),r=e.id}await M.authControllerSignUp({authCredentialsDto:t,userGroupId:r}),i.Am.success("Користувач успішно доданий")}catch(e){i.Am.error("Помилка! Пароль та логін повинні бути не менш ніж 4 символи кожний."),await x.withPostMiddleware(k(n)).userGroupsControllerDeleteUserGroup({userGroupId:r})}}}},R=()=>{const e=g(),{signin:t}=T(),[n,o]=(0,r.useState)(""),[a,i]=(0,r.useState)(""),s=(0,r.useCallback)((()=>{t({username:a,password:n})}),[n,a]),f=(0,r.useCallback)((e=>{"Enter"===e.key&&s()}),[n,a]);return r.createElement(v.Z,{component:"main",maxWidth:"xs"},r.createElement("div",{className:e.paper},r.createElement(l.Z,{className:e.avatar},r.createElement(h.Z,null)),r.createElement(p.Z,{component:"h1",variant:"h5"},"Увійти"),r.createElement("form",{className:e.form,noValidate:!0},r.createElement(d.Z,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,id:"username",label:"Ім'я",name:"username",autoComplete:"username",autoFocus:!0,value:a,onChange:e=>i(e.target.value),onKeyUp:f}),r.createElement(d.Z,{variant:"outlined",margin:"normal",required:!0,fullWidth:!0,name:"password",label:"Пароль",type:"password",id:"password",autoComplete:"current-password",value:n,onChange:e=>o(e.target.value),onKeyUp:f}),r.createElement(u.Z,{control:r.createElement(m.Z,{value:"remember",color:"primary"}),label:"Запам'ятати мене"}),r.createElement(c.Z,{type:"button",fullWidth:!0,variant:"contained",color:"primary",onClick:s,className:e.submit},"Увійти"))))};var G=n(6010),U=n(5258),q=n(8358),N=n(7812),B=n(998),F=n(6869),O=n(2822),j=n(5757),$=n(2112),L=n(8884),z=n(1749),W=n(3646),H=n(5730),Q=n(1933);const V=(0,f.Z)((e=>({root:{display:"flex"},hide:{display:"none"},list:{width:250},drawerHeader:{display:"flex",alignItems:"center",padding:e.spacing(0,1),...e.mixins.toolbar,justifyContent:"flex-end"},toolbar:{paddingRight:24},toolbarIcon:{display:"flex",alignItems:"center",justifyContent:"flex-end",padding:"0 8px",...e.mixins.toolbar},menuButton:{marginRight:36},menuButtonHidden:{display:"none"},title:{flexGrow:1},appBarSpacer:e.mixins.toolbar,content:{flexGrow:1,height:"100vh",overflow:"auto"},container:{padding:e.spacing(1,2)},paper:{padding:e.spacing(2),display:"flex",overflow:"auto",flexDirection:"column"},fixedHeight:{height:240},name:{marginRight:e.spacing(4)},orange:{color:e.palette.getContrastText(Q.Z[500]),backgroundColor:Q.Z[500]}})));var K=n(6245),_=n(1221),Y=n(3513);const J=()=>{const e=(0,I.I0)(),t=(0,r.useCallback)((()=>{b(),e(Z.l.actions.setCurrentUser(null)),e(_.qH.actions.photosRemove()),e(Y.b7.actions.removeAllDevices())}),[]);let n=(0,I.v9)((e=>e.users.currentUser));if(!n){const t=E(),r=t?(0,K.Z)(t):null;e(Z.l.actions.setCurrentUser(r)),n=r}return{isLogged:Boolean(n),user:n,logout:t}};var X=n(3727);const ee=[{path:"/users",title:"Користувачи",icon:r.createElement(W.Z,null)},{path:"/devices",title:"Пристрої",icon:r.createElement(H.Z,null)}],te=({children:e})=>{const t=V(),[n,o]=(0,r.useState)(!1),{logout:a,user:i,isLogged:s}=J(),d=e=>t=>{("keydown"!==t.type||"Tab"!==t.key&&"Shift"!==t.key)&&o(e)};return r.createElement("div",{className:t.root},r.createElement(U.Z,{position:"fixed"},r.createElement(q.Z,{className:t.toolbar},s&&r.createElement(N.Z,{color:"inherit","aria-label":"open drawer",onClick:d(!0),edge:"start",className:(0,G.Z)(t.menuButton,n&&t.hide)},r.createElement(L.Z,null)),r.createElement(p.Z,{component:"h1",variant:"h6",color:"inherit",noWrap:!0,className:t.title},'Система керування "М камера"'),s&&r.createElement(r.Fragment,null,r.createElement(p.Z,{component:"p",className:t.name},null==i?void 0:i.username),(null==i?void 0:i.isAdmin)&&r.createElement(l.Z,{className:`${t.orange} ${t.name}`},"AD"),r.createElement(c.Z,{color:"default",variant:"contained",onClick:a},"Вихід")))),r.createElement($.ZP,{anchor:"left",open:n,onClose:d(!1)},r.createElement("div",{className:t.list,onClick:d(!1),onKeyDown:d(!1)},r.createElement(O.Z,null,ee.map(((e,t)=>r.createElement(B.Z,{button:!0,key:t,component:X.rU,to:e.path},r.createElement(F.Z,null,e.icon),r.createElement(j.Z,{primary:e.title}))))))),r.createElement("main",{className:(0,G.Z)(t.content)},r.createElement("div",{className:t.appBarSpacer}),r.createElement(v.Z,{maxWidth:"xl",className:t.container},r.createElement(z.Z,{container:!0,spacing:3},r.createElement(z.Z,{item:!0,xs:12},r.createElement("div",{className:t.paper},e))))))};var ne=n(2448),re=n(9895);const oe=(0,f.Z)((e=>({icon:{width:192,height:192,color:e.palette.secondary.main},container:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%"},paper:{backgroundColor:e.palette.background.default,margin:0,height:"calc(100vh - 64px)"},button:{marginTop:20}}))),ae=()=>{const e=oe();return r.createElement(re.Z,{className:e.paper},r.createElement("div",{className:e.container},r.createElement(p.Z,{variant:"h4"},"404"),r.createElement(p.Z,{variant:"subtitle1"},"Сторінку не знайдено"),r.createElement(c.Z,{color:"secondary","aria-label":"home",href:"/",className:e.button},r.createElement(ne.Z,null))))},ie=()=>{const e=(0,o.TH)(),t=(0,o.k6)(),[n,a]=(0,r.useState)(e);(0,r.useEffect)((()=>{e.pathname.includes("modals")||a(e)}),[e.pathname]);const i=(0,r.useCallback)(((e,r)=>{const o={isModal:!0,previousLocation:n||t.location,meta:r};t.push(`/modals/${e}`,o)}),[t]);return{previousLocation:n,location:e,isModal:e.pathname.includes("modals"),goBack:()=>{n?t.push(n):t.push("/")},history:t,redirectToModal:i}};var se=n(2663),le=n(6856),ce=n(9525),de=n(7212),ue=n(6083),me=n(5117);const he=(0,r.createContext)({dialogObj:null,setDialogObj:()=>{}}),pe=(0,f.Z)((e=>(0,me.Z)({paper:{minWidth:e.spacing(60)}}))),ve=({children:e})=>{const t=pe(),[n,o]=(0,r.useState)(null);return r.createElement(r.Fragment,null,r.createElement(he.Provider,{value:{dialogObj:n,setDialogObj:o}},e),n&&r.createElement(se.Z,{classes:{paper:t.paper},open:n.isShown,onClose:()=>o(null)},r.createElement(ue.Z,null,n.title),r.createElement(ce.Z,null,r.createElement(de.Z,null,n.text)),r.createElement(le.Z,null,r.createElement(c.Z,{onClick:()=>{var e;null===(e=null==n?void 0:n.onApprove)||void 0===e||e.call(n),o(null)},color:"primary"},"Підтвердити"),r.createElement(c.Z,{onClick:()=>{var e;null===(e=null==n?void 0:n.onCancel)||void 0===e||e.call(n),o(null)},color:"primary",autoFocus:!0},"Скасувати"))))};var fe=({canActive:e=(()=>!0),redirectTo:t="/",...n})=>r.createElement(r.Fragment,null,e()?r.createElement(o.AW,Object.assign({},n)):r.createElement(o.l_,{from:n.path,to:t,exact:!0})),ge=n(8715);const we=()=>(0,I.v9)((e=>e.server.wsConnectionStatus))?null:r.createElement(z.Z,{container:!0,spacing:0,justify:"center",style:{marginBottom:"16px"}},r.createElement(ge.Z,{elevation:6,variant:"filled",severity:"error"},"З'єднання з сервером втрачено. Синхронізація пристроїв не працює. Спробуйте перезавантажити сторінку."));var ye=n(7638),Ce=n(8334);const Ee=(0,ye.Z)({palette:{info:{main:Ce.Z[600],light:Ce.Z[500]}}});var be=n(2014),De=n(7708),Ie=n(743),Ze=n(1201),ke=n(4566),Ae=n(8428),xe=n(9067);const Se=(0,f.Z)((e=>({memberControls:{display:"flex",alignItems:"center",[e.breakpoints.up("sm")]:{justifyContent:"flex-end"}}}))),Pe=({user:e,editUser:t,removeUser:n})=>{const o=Se();return r.createElement(B.Z,null,r.createElement(z.Z,{container:!0},r.createElement(z.Z,{item:!0,xs:12,sm:6,className:o.memberControls},r.createElement(j.Z,{primary:e.username})),r.createElement(z.Z,{item:!0,xs:12,sm:6,className:o.memberControls},e.isAdmin&&r.createElement(p.Z,{variant:"h6"},"Админ"),r.createElement(N.Z,{"aria-label":"edit",onClick:()=>t(e.id),edge:"end"},r.createElement(xe.Z,{color:"primary"})),r.createElement(N.Z,{"aria-label":"delete",onClick:()=>n(e.id),edge:"end"},r.createElement(Ae.Z,{color:"error"})))))};var Me=n(6562);const Te={editDevice:{title:"Редагувати Пристрої",description:"Редагувати Пристрої"},addDevice:{title:"Додавати пристрої",description:"Додавати пристрої"},removeDevice:{title:"Видаляти пристрої",description:"Видаляти пристрої"},removePhoto:{title:"Видаляти фото",description:"Видаляти фото"},download:{title:"Вигружати фото",description:"Вигружати фото"}},Re=["addDevice","removeDevice","editDevice","download","removePhoto"],Ge=({permissionsValues:e,disabled:t=!1,handleChange:n})=>r.createElement(be.Z,null,r.createElement(Me.Z,{row:!0},Re.map((o=>r.createElement(u.Z,{key:o,control:r.createElement(m.Z,{checked:e[o],onChange:n?n(o):void 0,value:e[o],disabled:t}),label:Te[o].title,title:Te[o].description})))));var Ue=n(5477),qe=function({isLoading:e,children:t,size:n=24}){return r.createElement(r.Fragment,null,e?r.createElement(Ue.Z,{size:n,style:{marginRight:"8px"}}):null,t)},Ne=function({isLoading:e,disabled:t,children:n,loaderSize:o,...a}){return r.createElement(c.Z,Object.assign({},{disabled:t||e,...a}),r.createElement(qe,{isLoading:e,size:o},n))};const Be=new w.iW(new w.VK({accessToken:E,basePath:(0,D.b)()})),Fe=new w.jq(new w.VK({accessToken:E,basePath:(0,D.b)()})),Oe=()=>{const e=(0,I.I0)(),t=(0,r.useCallback)((()=>(async()=>{try{const t=await Be.withPostMiddleware(k(e)).usersControllerGetUsersWithDevices();e(Z.l.actions.usersReceived(t))}catch(e){i.Am.error(e.statusText)}})()),[]),n=(0,r.useCallback)((()=>(async()=>{try{const t=await Fe.withPostMiddleware(k(e)).permissionsControllerGetUserPermissions(),{userId:n,user:r,id:o,...a}=t;return e(Z.l.actions.setCurrentUserPermissions(a)),a}catch(e){return void i.Am.error(e.statusText||"Error Get Permissions")}})()),[]);return{getUsersWithDevices:t,removeUserAdmin:(0,r.useCallback)((t=>(async()=>{try{await Be.withPostMiddleware(k(e)).usersControllerRemoveUser({userId:t}),e(Z.l.actions.removeUser(t)),e(P.Nn.actions.removeUser({userId:t})),i.Am.success("Користувач успішно видалений.")}catch(e){const t=await e.json();i.Am.error(t.error)}})()),[]),editUserAdmin:(0,r.useCallback)(((t,n)=>(async()=>{try{const r=await Be.withPostMiddleware(k(e)).usersControllerEditUser({userId:t,authCredentialsDto:n});e(Z.l.actions.updateUser({changes:r,id:t})),i.Am.success("Дані успішно оновлений.")}catch(e){const t=await e.json();i.Am.error(t.error)}})()),[]),getUsersPermissions:n,updateUserPermissions:(0,r.useCallback)(((t,n)=>(async()=>{try{const r=await Fe.withPostMiddleware(k(e)).permissionsControllerUpdatePermissions({userId:t,createPermissionDto:n}),{user:o,id:a,...i}=r;return e(Z.l.actions.setUserPermissions(i)),e(P.Nn.actions.setUserPermissions(i)),i}catch(e){return void i.Am.error(e.statusText)}})()),[])}};var je=({userId:e})=>{var t;const n=(null===(t=(0,I.v9)(P.f3.selectAll).flatMap((e=>e.users)).find((t=>t.id===e)))||void 0===t?void 0:t.permission)||{download:!1,addDevice:!1,removeDevice:!1,editDevice:!1,removePhoto:!1},o=(e=>{const[t,n]=(0,r.useState)({...e});return(0,r.useEffect)((()=>{n({...e})}),[e]),{handleChange:e=>(r,o)=>{n({...t,[e]:o})},permissionsValues:t}})(n),{updateUserPermissions:a}=Oe(),[i,s]=(0,r.useState)(!1),l=(0,r.useCallback)((async()=>{s(!0),await a(e,o.permissionsValues),s(!1)}),[o.permissionsValues,e,a]),c=(0,r.useMemo)((()=>{const e={...n};return Re.some((t=>e[t]!==o.permissionsValues[t]))}),[n,o.permissionsValues]);return r.createElement(be.Z,{display:"flex",width:"100%",alignItems:"center"},r.createElement(be.Z,{flexGrow:1},r.createElement(Ge,Object.assign({},o))),r.createElement(Ne,{disabled:!c||i,variant:"contained",color:"primary",onClick:l,isLoading:i},"Зберегти"))};const $e=({editUser:e,removeUser:t,users:n,handleAddLocalUser:o,handleRemoveGroup:a})=>r.createElement(z.Z,{container:!0,direction:"column",spacing:3,alignItems:"center"},r.createElement(be.Z,{alignSelf:"center",display:"flex",flexWrap:"wrap",justifyContent:"center"},r.createElement(be.Z,{p:1},r.createElement(c.Z,{variant:"contained",color:"primary",onClick:o},"Додати Користувача")),r.createElement(be.Z,{p:1},r.createElement(c.Z,{variant:"contained",color:"secondary",onClick:a},"Видалити группу"))),r.createElement(z.Z,{item:!0,xs:12},r.createElement(O.Z,null,n.map(((n,o)=>r.createElement(De.Z,{key:n.id},r.createElement(Ie.Z,{expandIcon:r.createElement(ke.Z,null)},r.createElement(Pe,{key:n.id,user:n,ind:o,removeUser:t,editUser:e})),r.createElement(Ze.Z,null,r.createElement(je,{userId:n.id})))))))),Le=()=>{const{setDialogObj:e}=(0,r.useContext)(he),{userGroups:t}=(()=>{const e=(0,I.v9)(A.f.selectAll),{getUserGroups:t}=S(),n=(0,r.useCallback)((()=>{t()}),[]);return(0,r.useEffect)((()=>{n()}),[]),{userGroups:e,initUserGroups:n}})(),{removeUserAdmin:n}=Oe(),{removeUserGroup:a}=S(),s=(0,o.k6)(),l=r=>{var o;const s=t.find((e=>e.users.find((e=>e.id===r))));((null===(o=null==s?void 0:s.devices)||void 0===o?void 0:o.length)||0)>0?i.Am.error("Неможливо видалити поки є активні пристрої."):e({text:"Видалити користувача?",title:"Попередження",isShown:!0,onApprove:async()=>{await n(r),1===(null==s?void 0:s.users.length)&&a(s.id)}})};return r.createElement(be.Z,null,r.createElement(be.Z,{pb:2},r.createElement(c.Z,{variant:"contained",color:"primary",onClick:()=>{s.push("/users/add")}},"Додати Нового Користувача (группа)")),t.map((n=>r.createElement($e,{key:n.id,editUser:e=>{return t=e,r=n.id,void s.push(`/users/edit/${t}/${r}`);var t,r},removeUser:l,users:n.users,handleAddLocalUser:()=>{return e=n.id,void s.push(`/users/add/${e}`);var e},handleRemoveGroup:()=>(n=>{var r,o;const s=t.find((e=>e.id===n));((null===(r=null==s?void 0:s.devices)||void 0===r?void 0:r.length)||0)>0?i.Am.error("Неможливо видалити поки є активні пристрої."):((null===(o=null==s?void 0:s.users)||void 0===o?void 0:o.length)||0)>0?i.Am.error("Неможливо видалити поки є активні користувачі."):e({text:"Видалити группу користувачів?",title:"Попередження",isShown:!0,onApprove:()=>{t[0].id===n?i.Am.error("Не можна видалити групу системного користувача"):a(n)}})})(n.id)}))))},ze=(0,f.Z)((e=>(0,me.Z)({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"45ch"},display:"flex",flexDirection:"column",alignItems:"stretch"},row:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",alignItems:"flex-end"},rowDivider:{marginTop:e.spacing(6)},buttonsRow:{justifyContent:"center"},mr:{marginRight:e.spacing(2)},mt:{marginTop:e.spacing(2)},mb:{marginBottom:e.spacing(2)}}))),We=({userData:e,title:t,onApprove:n,onCancel:o})=>{const a=ze(),[i,s]=(0,r.useState)(e||{username:"",password:"",isAdmin:!1}),l=e=>t=>{s({...i,[e]:"isAdmin"===e?t.target.checked:t.target.value})},h=(0,r.useCallback)((()=>{n(i)}),[i]),v=(0,r.useCallback)((()=>{o()}),[]);return r.createElement("form",{className:a.root,noValidate:!0,autoComplete:"off"},r.createElement("div",{className:`${a.row} ${a.mt} ${a.mb}`},r.createElement(p.Z,{component:"h4",variant:"h4"},t)),r.createElement("div",{className:a.row},r.createElement(d.Z,{required:!0,variant:"outlined",label:"Ім'я користувача",value:i.username,onChange:l("username")}),r.createElement(d.Z,{required:!0,variant:"outlined",label:"Пароль користувача",value:i.password,onChange:l("password")}),r.createElement(u.Z,{style:{alignSelf:"center"},control:r.createElement(m.Z,{checked:i.isAdmin,onChange:l("isAdmin"),color:"primary"}),label:"Адмін"})),r.createElement("div",{className:`${a.row} ${a.buttonsRow} ${a.rowDivider}`},r.createElement(c.Z,{className:a.mr,variant:"contained",color:"primary",onClick:h},"Підтвердити"),r.createElement(c.Z,{variant:"contained",color:"default",onClick:v},"Скасувати")))};var He=n(1182);const Qe=(0,f.Z)((e=>(0,me.Z)({modal:{display:"flex",padding:e.spacing(1),alignItems:"center",justifyContent:"center"},paper:{width:e=>e.size||"80%",backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(2,4,3),maxHeight:"95%",overflow:"auto"}})));var Ve=e=>t=>{const{size:n,onClose:o,...a}=t,i=Qe({size:n});return r.createElement(He.Z,{onClose:o,open:!0,className:i.modal},r.createElement("div",{className:i.paper},r.createElement(e,Object.assign({},{},a,{onClose:o}))))};const Ke=Ve((({onClose:e,match:{params:{userGroupId:t}}})=>{const{setDialogObj:n}=(0,r.useContext)(he),{signup:o}=T(t),{getUserGroups:a}=S(),i=(0,r.useCallback)((t=>{n({text:"Додати Нового Користувача?",title:"Попередження",isShown:!0,onApprove:async()=>{await o(t),a(),e()},onCancel:e})}),[]),s=(0,r.useCallback)((()=>{e()}),[]);return r.createElement(We,{title:"Додати Нового Користувача",onApprove:i,onCancel:s})})),_e=e=>{const t=(0,o.k6)(),n=(0,r.useCallback)((()=>{t.push("/users")}),[]);return r.createElement(Ke,Object.assign({onClose:n},e))},Ye=Ve((({onClose:e,match:{params:{userId:t,userGroupId:n}}})=>{const o=(0,I.v9)((e=>P.f3.selectById(e,n))),a=null==o?void 0:o.users.find((e=>e.id===+t)),{setDialogObj:i}=(0,r.useContext)(he),{editUserAdmin:s}=Oe(),{getUserGroups:l}=S(),c=(0,r.useCallback)((t=>{i({text:"Підтвердити нові дані користувача?",title:"Попередження",isShown:!0,onApprove:async()=>{a&&(await s(a.id,t),l()),e()},onCancel:e})}),[]),d=(0,r.useCallback)((()=>{e()}),[]);return a?r.createElement(We,{userData:{...a,password:""},title:"Редагувати Користувача",onApprove:c,onCancel:d}):r.createElement(p.Z,{variant:"h6"},"Користувач не знайдений")})),Je=e=>{const t=(0,o.k6)(),n=(0,r.useCallback)((()=>{t.push("/users")}),[]);return r.createElement(Ye,Object.assign({onClose:n},e))},Xe=()=>r.createElement(r.Fragment,null,r.createElement(Le,null),r.createElement(o.rs,null,r.createElement(o.AW,{path:"/users/add/:userGroupId",component:_e}),r.createElement(o.AW,{path:"/users/add",component:_e}),r.createElement(o.AW,{path:"/users/edit/:userId/:userGroupId",component:Je})));var et=n(8781);const tt=new w.d_(new w.VK({accessToken:E,basePath:(0,D.b)()})),nt=()=>{const e=(0,I.I0)(),t=(0,r.useCallback)((()=>(async()=>{try{const t=await tt.withPostMiddleware(k(e)).devicesControllerGetUserDevices();e(Y.b7.actions.devicesReceived(t))}catch(e){i.Am.error(e.statusText)}})()),[]);return{updateDevice:(0,r.useCallback)(((t,n)=>(async()=>{try{const r=await tt.withPostMiddleware(k(e)).devicesControllerUpdateDevice({id:t,createDeviceDto:n});return e(Y.b7.actions.updateDevice({changes:r,id:t})),i.Am.success('Дані відправлені на сервер. Слідкуйте за зміною "Статус Пакета".'),!0}catch(e){return i.Am.error(e.statusText),!1}})()),[]),removeDevice:(0,r.useCallback)((t=>(async()=>{try{await tt.withPostMiddleware(k(e)).devicesControllerDeleteDeviceRaw({id:t}),e(Y.b7.actions.removeDevice(t)),i.Am.success("Пристрій успішно видалено.")}catch(e){i.Am.error(e.statusText)}})()),[]),getDevices:t,createDevice:(0,r.useCallback)((t=>(async()=>{try{const n=await tt.withPostMiddleware(k(e)).devicesControllerCreateDevice({createDeviceDto:t});return e(Y.b7.actions.deviceAdded(n)),i.Am.success("Новий пристрій успішно доданий."),n}catch(e){return void i.Am.error(e.statusText)}})()),[]),createDeviceAdmin:(0,r.useCallback)(((t,n)=>(async()=>{try{const r=await tt.withPostMiddleware(k(e)).devicesControllerCreateDeviceAdmin({userId:n,createDeviceDto:t});return e(et.lr.actions.addDeviceActionAdmin({device:r,userId:n})),i.Am.success("Новий пристрій успішно доданий."),r}catch(e){return void i.Am.error(e.statusText)}})()),[]),removeDeviceAdmin:(0,r.useCallback)(((t,n)=>(async()=>{try{await tt.withPostMiddleware(k(e)).devicesControllerRemoveDeviceAdmin({userId:n,deviceId:t}),e(et.lr.actions.removeDeviceActionAdmin({deviceId:t,userId:n})),i.Am.success("Пристрій успішно видалено.")}catch(e){i.Am.error(e.statusText)}})()),[]),updateDeviceAdmin:(0,r.useCallback)(((t,n,r)=>(async()=>{try{const o=await tt.withPostMiddleware(k(e)).devicesControllerUpdateDeviceAdmin({userId:n,deviceId:t,createDeviceDto:r});return e(et.lr.actions.updateDeviceActionAdmin(o)),i.Am.success('Дані відправлені на сервер. Слідкуйте за зміною "Статус Пакета".'),!0}catch(e){return i.Am.error(e.statusText),!1}})()),[])}};var rt=n(1860),ot=n(9969),at=n(3457),it=n(1041),st=n(3770),lt=n(1959),ct=n(2230),dt=n(6447);const ut=e=>Date.now()-e.getTime()<9e4;var mt;!function(e){e.CHECK="CHECK",e.SENDING="SENDING",e.WAITING="WAITING"}(mt||(mt={}));const ht={[mt.WAITING]:r.createElement(st.Z,{style:{color:Ee.palette.info.main}}),[mt.SENDING]:r.createElement(Ue.Z,{size:"1.5rem"}),[mt.CHECK]:r.createElement(lt.Z,{style:{color:Ee.palette.info.main}})},pt=({device:e})=>{const{deviceStatus:t}=(e=>{const[t,n]=(0,r.useState)(ut(e)),[o,a]=(0,r.useState)(0);return(0,r.useEffect)((()=>{clearTimeout(o),n(ut(e)),a(window.setTimeout((()=>{t&&n(!1)}),9e4))}),[e]),{deviceStatus:t}})(e.packet.lastPacketTime),[n,o]=(0,r.useState)(mt.WAITING);return(0,r.useEffect)((()=>{e.packet.status===w.WL.NONE&&n===mt.SENDING?(o(mt.CHECK),setTimeout((()=>{o(mt.WAITING)}),2e3)):e.packet.status===w.WL.NONE?o(mt.WAITING):e.packet.status!==w.WL.SENDING&&e.packet.status!==w.WL.TOSEND||o(mt.SENDING)}),[e.packet.status]),r.createElement(be.Z,{display:"flex",alignItems:"center",color:t?Ee.palette.info.main:Ee.palette.error.main},r.createElement(dt.ZP,{title:t?"Online":"Offline",placement:"top"},r.createElement(ct.Z,null)),ht[n])},vt=(0,f.Z)((e=>(0,me.Z)({root:{"& .MuiTextField-root":{margin:e.spacing(1),width:"45ch"},display:"flex",flexDirection:"column",alignItems:"stretch"},row:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",alignItems:"flex-end"},rowDivider:{marginTop:e.spacing(6)},buttonsRow:{justifyContent:"center"},mr:{marginRight:e.spacing(2)},mt:{marginTop:e.spacing(2)},mb:{marginBottom:e.spacing(2)},deviceFormAction:{display:"flex",alignItems:"center"}})));var ft=Ve((({onApprove:e,onDecline:t})=>{const n=vt(),[o,a]=(0,r.useState)({identifier:"",name:""}),[i,s]=(0,r.useState)({identifier:""===o.identifier}),l=e=>t=>{s({...i,[e]:0===t.target.value.length}),"identifier"===e&&s({...i,[e]:0===t.target.value.length}),a({...o,[e]:t.target.value})},u=(0,r.useCallback)((()=>{e(o)}),[o]),m=(0,r.useCallback)((()=>{t()}),[]);return r.createElement("form",{className:n.root,noValidate:!0,autoComplete:"off"},r.createElement("div",{className:`${n.row} ${n.mt} ${n.mb}`},r.createElement(p.Z,{component:"h4",variant:"h4"},"Додати новий пристрій")),r.createElement("div",{className:n.row},r.createElement(d.Z,{variant:"outlined",required:!0,label:"ID Пристрія",value:o.identifier,error:i.identifier,onChange:l("identifier"),helperText:i.identifier&&o.identifier.length>0?"Невірний формат":""}),r.createElement(d.Z,{variant:"outlined",label:"Ім'я Пристрія",required:!0,value:o.name,error:i.identifier,onChange:l("name")})),r.createElement("div",{className:`${n.row} ${n.buttonsRow} ${n.rowDivider}`},r.createElement(c.Z,{className:n.mr,variant:"contained",color:"primary",onClick:u,disabled:Object.values(i).some(Boolean)},"Підтвердити"),r.createElement(c.Z,{variant:"contained",color:"default",onClick:m},"Скасувати")))})),gt=n(3564),wt=n(3055);const yt={identifier:"",name:"",scheduleFrequencyPhoto:1,scheduleDurationPhoto:1,scheduleFramesQuantity:1,movementCells:[],movementDiffLevel:1,movementChangeFrameTime:1,movementFrequencyAnalyzing:1,circleDurationBeforeMoveSensor:1,circleFramesQuantityBeforeMove:1,circleDurationDuringMoveSensorUnit:w.NY.Seconds,circleDurationDuringMoveSensor:1,circleFramesQuantityDuringMove:1,circleDurationAfterMoveSensor:1,circleFramesQuantityAfterMove:1,randomSymbols:""},Ct=(e,t)=>n=>r=>n[r]>=e&&n[r]<=t,Et=({label:e,name:t,type:n})=>r.createElement(be.Z,{display:"flex",alignItems:"center",mb:1},r.createElement(p.Z,{variant:"caption",style:{marginRight:8}},e),r.createElement(gt.gN,{component:wt.nv,type:n,variant:"outlined",InputLabelProps:{shrink:!0},size:"small",name:t})),bt=Ct(1,1440),Dt=Ct(1,100),It=(Ct(1,3600),({onApprove:e,device:t,onClose:n})=>{const o=vt(),{id:a,packet:i,userGroupsId:s,circleDurationDuringMoveSensorUnit:l,userGroups:d,photo:u,...m}=t,[h,v]=(0,r.useState)({...yt,...m});return r.createElement(gt.J9,{initialValues:{...yt,...m},validate:e=>{v(e);const t={};return e.identifier||(t.identifier="Required"),e.randomSymbols.length>10&&(t.randomSymbols="Not Valid"),Ct(1,86400)(e)("scheduleFrequencyPhoto")||(t.scheduleFrequencyPhoto="Not Valid"),Ct(1,30*h.scheduleFrequencyPhoto)(e)("scheduleDurationPhoto")||(t.scheduleDurationPhoto="Not Valid"),Ct(1,h.scheduleDurationPhoto)(e)("scheduleFramesQuantity")||(t.scheduleFramesQuantity="Not Valid"),Dt(e)("movementDiffLevel")||(t.movementDiffLevel="Not Valid"),bt(e)("movementChangeFrameTime")||(t.movementChangeFrameTime="Not Valid"),Ct(1,h.movementChangeFrameTime<5?60*h.movementChangeFrameTime:300)(e)("movementChangeFrameTime")||(t.movementFrequencyAnalyzing="Not Valid"),Ct(0,3600)(e)("circleDurationBeforeMoveSensor")||(t.circleDurationBeforeMoveSensor="Not Valid"),Ct(0,h.circleDurationBeforeMoveSensor)(e)("circleFramesQuantityBeforeMove")||(t.circleFramesQuantityBeforeMove="Not Valid"),Ct(1,h.circleDurationDuringMoveSensorUnit===w.NY.Seconds?3600:1440)(e)("circleDurationDuringMoveSensor")||(t.circleDurationDuringMoveSensor="Not Valid"),Ct(1,3600)(e)("circleFramesQuantityDuringMove")||(t.circleFramesQuantityDuringMove="Not Valid"),Ct(0,3600)(e)("circleDurationAfterMoveSensor")||(t.circleDurationAfterMoveSensor="Not Valid"),Ct(0,h.circleDurationAfterMoveSensor)(e)("circleFramesQuantityAfterMove")||(t.circleFramesQuantityAfterMove="Not Valid"),t},onSubmit:n=>{e(n,t.id)}},(({submitForm:e,errors:t})=>r.createElement(gt.l0,null,r.createElement(p.Z,{variant:"subtitle2",gutterBottom:!0},"Загальні"),r.createElement(be.Z,{display:"flex",flexWrap:"wrap"},r.createElement(gt.gN,{component:wt.nv,name:"identifier",type:"string",label:"ID Пристрія",variant:"outlined",size:"small",className:o.mr}),r.createElement(gt.gN,{component:wt.nv,type:"string",label:"Ім'я Пристрія",className:o.mr,variant:"outlined",name:"name",size:"small"}),r.createElement(gt.gN,{component:wt.nv,type:"string",label:"Набір символів",variant:"outlined",name:"randomSymbols",size:"small"})),r.createElement("br",null),r.createElement(p.Z,{variant:"subtitle2",gutterBottom:!0},"Налаштування зйомки фото за розкладом"),r.createElement(be.Z,{display:"flex",flexDirection:"column"},r.createElement(Et,{type:"number",label:"Частота виконання зйомки фото, с (1 - 86400)",name:"scheduleFrequencyPhoto"}),r.createElement(Et,{type:"number",label:`Тривалість періоду зйомки фото, с (1 - ${30*h.scheduleFrequencyPhoto})`,name:"scheduleDurationPhoto"}),r.createElement(Et,{type:"number",label:`Кількість кадрів фото за тривалість періоду зйомки (1 - ${h.scheduleDurationPhoto})`,name:"scheduleFramesQuantity"})),r.createElement("br",null),r.createElement(p.Z,{variant:"subtitle2"},"Налаштування датчика руху"),r.createElement(be.Z,{display:"flex",flexDirection:"column"},r.createElement(Et,{label:"Настройка рівня зміни між опорним і аналізованих кадрами, % (1 - 100)",name:"movementDiffLevel",type:"number"})),r.createElement("br",null),r.createElement(p.Z,{variant:"subtitle2",gutterBottom:!0},"Параметри кільцевого буфера кадрів до спрацьовування датчика руху:"),r.createElement(be.Z,{display:"flex",flexDirection:"column"},r.createElement(Et,{type:"number",label:"Тривалість періоду зйомки фото, с. (0 - 3600)",name:"circleDurationBeforeMoveSensor"}),r.createElement(Et,{type:"number",label:`Кількість кадрів фото за тривалість періоду зйомки (1 - ${h.circleDurationBeforeMoveSensor})`,name:"circleFramesQuantityBeforeMove"})),r.createElement("br",null),r.createElement(p.Z,{variant:"subtitle2",gutterBottom:!0},"Параметри кільцевого буфера кадрів під час спрацьовування датчика руху:"),r.createElement(be.Z,{display:"flex",flexDirection:"column",alignItems:"flex-start"},r.createElement(Et,{type:"number",label:"Частота збереження фото, с (1 - 3600)",name:"circleFramesQuantityDuringMove"})),r.createElement("br",null),r.createElement(p.Z,{variant:"subtitle2",gutterBottom:!0},"Параметри кільцевого буфера кадрів по закінченню спрацьовування датчика руху:"),r.createElement(be.Z,{display:"flex",flexDirection:"column"},r.createElement(Et,{type:"number",label:"Тривалість періоду зйомки фото, с. (0 - 3600)",name:"circleDurationAfterMoveSensor"}),r.createElement(Et,{type:"number",label:`Кількість кадрів фото за тривалість періоду зйомки (1 - ${h.circleDurationAfterMoveSensor})`,name:"circleFramesQuantityAfterMove"})),r.createElement("br",null),r.createElement(c.Z,{variant:"contained",color:"primary",disabled:Object.keys(t).length>0,onClick:e},"Редагувати"),r.createElement(c.Z,{variant:"contained",color:"secondary",onClick:n,style:{marginLeft:8}},"Закрити"))))});Ve(It);const Zt=new w._Q(new w.VK({accessToken:E,basePath:(0,D.b)()})),kt=()=>{const e=(0,I.I0)(),t=(0,r.useCallback)(((t,n,r)=>(async()=>{try{const o=await Zt.withPostMiddleware(k(e)).photosControllerGetPhotosById({deviceId:t,start:n,end:r});return e(_.qH.actions.photosReceived(o)),o}catch(e){return void i.Am.error(e.statusText)}})()),[]),n=(0,r.useCallback)((t=>(async()=>{try{await Zt.withPostMiddleware(k(e)).photosControllerGetPhotoByPath({imageName:t})}catch(e){i.Am.error(e.statusText)}})()),[]),o=(0,r.useCallback)((t=>(async()=>{try{await Zt.withPostMiddleware(k(e)).photosControllerRemovePhotoById({id:t}),e(_.qH.actions.photoRemove(t)),i.Am.success("Фото успішно видалено")}catch(e){i.Am.error(e.statusText)}})()),[]),a=(0,r.useCallback)((t=>(async()=>{try{await Zt.withPostMiddleware(k(e)).photosControllerRemovePhotosById({removePhotosDto:{ids:t}}),e(_.qH.actions.photoRemoveMany(t)),i.Am.success("Фото успішно видалені")}catch(e){i.Am.error(e.statusText)}})()),[]);return{getPhotos:t,getPhotoByPath:n,removePhotoById:o,getLastPhoto:(0,r.useCallback)((t=>(async()=>{try{return await Zt.withPostMiddleware(k(e)).photosControllerGetLastPhoto({deviceId:t})}catch(e){return void i.Am.error(e.statusText)}})()),[]),removePhotosById:a,downloadPhoto:(0,r.useCallback)((t=>(async()=>{try{await Zt.withPostMiddleware(k(e)).photosControllerDownloadPhotoByPath({imageName:t})}catch(e){i.Am.error(e.statusText)}})()),[])}},At=(0,f.Z)((()=>(0,me.Z)({root:{position:"absolute",left:0,top:0,backgroundColor:"transparent",display:"flex",flexWrap:"wrap",width:e=>e.width,height:e=>e.height},item:{cursor:"pointer",border:"1px solid gray"}}))),xt=({axisX:e,axisY:t,width:n,height:o,onSelect:a,selected:i})=>{const s=At({width:n,height:o}),l=(0,r.useRef)(null),c=(0,r.useMemo)((()=>n/e),[n,e]),d=(0,r.useMemo)((()=>o/t),[o,t]),u=(0,r.useMemo)((()=>{const n=new Array(e).fill(0);return new Array(t).fill(0).flatMap(((e,t)=>n.map(((e,n)=>r.createElement("div",{key:`${n}${t}`,className:s.item,style:{width:c,height:d,backgroundColor:`rgba(75, 255, 0, ${i.includes(`${n},${t}`)?.5:0})`},onClick:()=>a(n,t)})))))}),[c,d,e,t,i]);return r.createElement("div",{className:s.root,ref:l},u)},St=(0,D.b)(),Pt=({selected:e,onSelect:t,deviceId:n})=>{var o,a;const i=(0,r.useRef)(null),[s,l]=(0,r.useState)(void 0),[c,d]=(0,r.useState)(!0),{getLastPhoto:h}=kt(),{handleLoad:p}=(()=>{const[e,t]=(0,r.useState)(0),[n,o]=(0,r.useState)(0);return{handleLoad:(0,r.useCallback)((e=>{const n=document.createElement("img");n.src=e,n.hidden=!0,document.body.appendChild(n),n.addEventListener("load",(()=>{o(n.height),t(n.width),document.body.removeChild(n)})),n.addEventListener("error",(()=>{document.body.removeChild(n)}))}),[]),width:e,height:n}})();return(0,r.useEffect)((()=>{h(n).then(l)}),[h]),(0,r.useEffect)((()=>{s&&p(`${St}/photos/preview/${s.name}`)}),[p,s]),s?r.createElement(be.Z,{display:"flex",flexDirection:"column",mr:2},r.createElement("div",{style:{position:"relative",maxWidth:640,maxHeight:480}},r.createElement("img",{src:`${St}/photos/preview/${s.name}`,alt:"photo",ref:i,style:{maxHeight:"100%",maxWidth:"100%"}}),c&&r.createElement(xt,{width:(null===(o=i.current)||void 0===o?void 0:o.clientWidth)||0,height:(null===(a=i.current)||void 0===a?void 0:a.clientHeight)||0,axisX:10,axisY:10,selected:e,onSelect:t})),r.createElement(u.Z,{control:r.createElement(m.Z,{checked:c,onChange:()=>d((e=>!e)),color:"primary"}),label:"Показати Сітку"})):null};var Mt=Ve((({onApprove:e,device:t,onClose:n})=>{const[o,a]=(0,r.useState)(t.movementCells),i=(0,r.useCallback)(((e,t)=>{const n=`${e},${t}`,r=o.find((e=>e===n));a(r?e=>e.filter((e=>e!==n)):e=>[...e,n])}),[o]),s=(0,r.useCallback)(((t,n)=>{e({...t,movementCells:o},n)}),[o,e]);return r.createElement(be.Z,{display:"flex",flexWrap:"wrap",justifyContent:"space-between"},r.createElement(Pt,{selected:o,onSelect:i,deviceId:t.id}),r.createElement(It,{device:t,onApprove:s,onClose:n}))}));var Tt=n(5241),Rt=n(6266),Gt=n(8792),Ut=n(6033),qt=n(950),Nt=n(4823),Bt=n(6838);const Ft=[Tt.Z,Tt.Z,Rt.Z,Rt.Z,Gt.Z,Ut.Z,Ut.Z,qt.Z,Nt.Z,Bt.Z],Ot=({level:e})=>{const t=Ft[Math.ceil(e/10)-1];return r.createElement(be.Z,{display:"flex",alignItems:"center"},e,"%",r.createElement(t,null))},jt=e=>{const t=(0,I.v9)((e=>e.users.userPermissions));var n;return{isAllowed:(n=t,e=>(Array.isArray(e)?e:[e]).every((e=>Object.entries(n).filter((([,e])=>e)).map((([e])=>e)).includes(e))))(e)}},$t=(0,r.forwardRef)((({children:e,permissions:t},n)=>{const a=(0,o.k6)(),{isAllowed:i}=jt(t),s=(0,r.useCallback)((e=>{e.stopPropagation(),e.preventDefault(),a.push("/modals/notAllowed")}),[a]);return i?r.createElement(r.Fragment,null,e):r.createElement("div",{onClickCapture:s,onSubmitCapture:s},e)})),Lt=({removeDevice:e,devices:t})=>{const n=(0,it.Z)(),a=(0,at.Z)(n.breakpoints.up("md")),{handleAddDevice:i,showAddModal:s,handleCloseAddModal:l,handleOpenAddModal:d}=(()=>{const{createDevice:e}=nt(),{showModal:t,handleOpenModal:n,handleCloseModal:o}=(()=>{const[e,t]=(0,r.useState)(!1);return{showModal:e,handleOpenModal:(0,r.useCallback)((()=>{t(!0)}),[]),handleCloseModal:(0,r.useCallback)((()=>{t(!1)}),[])}})();return{handleAddDevice:(0,r.useCallback)((t=>{e({...yt,...t}),o()}),[e]),showAddModal:t,handleOpenAddModal:n,handleCloseAddModal:o}})(),{deviceToUpdate:u,handleCloseEditModal:m,handleOpenEditModal:h,handleEditDevice:p}=(()=>{const{updateDevice:e}=nt(),[t,n]=(0,r.useState)(-1),o=(0,I.v9)((e=>Y.Me.selectById(e,t)));return{handleEditDevice:(0,r.useCallback)(((t,r)=>{e(r,{...yt,...t}),n(-1)}),[e]),deviceToUpdate:o,handleOpenEditModal:(0,r.useCallback)((e=>{n(e)}),[]),handleCloseEditModal:(0,r.useCallback)((()=>{n(-1)}),[])}})(),{selected:v,handleSelectDevice:f}=(()=>{const e=(0,o.k6)(),{id:t}=(0,o.UO)();return{selected:+(t||""),handleSelectDevice:(0,r.useCallback)((t=>{e.push(`/devices/${t}`)}),[])}})(),g=vt();return r.createElement(z.Z,{container:!0,direction:"column",alignItems:"stretch"},r.createElement(be.Z,{alignSelf:"center",mb:1},r.createElement($t,{permissions:"addDevice"},r.createElement(c.Z,{variant:"contained",color:"primary",onClick:d},"Додати Новий Пристрій"))),r.createElement(O.Z,{component:"nav"},t.length>0&&t.map((t=>r.createElement(B.Z,{key:t.id,button:!0,selected:v===t.id,onClick:()=>f(t.id)},r.createElement(j.Z,{primary:t.name}),r.createElement(rt.Z,{className:g.deviceFormAction},r.createElement(Ot,{level:t.battery||1}),r.createElement($t,{permissions:"editDevice"},r.createElement(N.Z,{edge:"end",onClick:()=>h(t.id),size:"small"},r.createElement(ot.Z,null))),r.createElement($t,{permissions:"removeDevice"},r.createElement(N.Z,{edge:"end",onClick:()=>e(t.id),size:"small"},r.createElement(Ae.Z,null))),r.createElement(pt,{device:t})))))),s&&r.createElement(ft,{onApprove:i,onDecline:l,onClose:l,size:a?"60%":"90%"}),u&&r.createElement(Mt,{device:u,onApprove:p,onClose:m,size:"unset"}))},zt=()=>{const e=(0,o.k6)(),{setDialogObj:t}=(0,r.useContext)(he),{devices:n}=(()=>{const e=(0,I.v9)(Y.Me.selectAll),{getDevices:t}=nt(),n=(0,r.useCallback)((()=>{t()}),[]);return(0,r.useEffect)((()=>{n()}),[]),{initDevices:n,devices:e}})(),{removeDevice:a}=nt();return(0,r.useEffect)((()=>{n.length&&e.push(`/devices/${n[0].id}`)}),[n.length]),r.createElement(Lt,{removeDevice:e=>{t({text:"Видалити пристрій?",title:"Попередження",isShown:!0,onApprove:()=>{a(e)}})},devices:n})},Wt=(0,f.Z)((e=>(0,me.Z)({paper:{padding:e.spacing(2),maxHeight:"calc(100vh - 300px)",overflow:"auto",minWidth:e.spacing(30)}}))),Ht=({children:e})=>{const t=Wt(),n=r.Children.toArray(e);return r.createElement(z.Z,{container:!0,justify:"space-between",spacing:2},r.createElement(z.Z,{item:!0,xs:12,md:4},r.createElement(re.Z,{className:t.paper},n[0])),r.createElement(z.Z,{item:!0,xs:12,md:8},n[1]))};var Qt=n(7827),Vt=n(5365),Kt=n(5490),_t=n.n(Kt),Yt=n(4395),Jt=n(1197),Xt=n(1843);const en=({value:e,handleBackDate:t,handleForwardDate:n,handleChange:o})=>r.createElement(be.Z,{display:"flex",alignItems:"center"},r.createElement(N.Z,{onClick:t},r.createElement(Xt.Z,null)),r.createElement(Yt.e,{label:"Дата",inputVariant:"outlined",value:e,onChange:o,format:"dd MMM yyyy"}),r.createElement(N.Z,{onClick:n},r.createElement(Jt.Z,null))),tn=({onLoad:e})=>{const[t,n]=(0,r.useState)(0),[o,a]=(0,r.useState)(new Date(Date.now())),i=(0,r.useCallback)((()=>{if(o){const t=o;t.setDate(o.getDate()+1),a(t),n((e=>e+1)),e(+t)}}),[o,e]),s=(0,r.useCallback)((t=>{t&&(a(t),e(+t))}),[e]);return r.createElement(Qt.M,{utils:Vt.Z,locale:_t()},r.createElement(z.Z,{container:!0,justify:"space-evenly",direction:"row",alignItems:"center",spacing:1},r.createElement(z.Z,{item:!0},r.createElement(en,{key:t,handleBackDate:()=>{if(o){const t=o;t.setDate(o.getDate()-1),a(t),n((e=>e+1)),e(+t)}},handleChange:s,handleForwardDate:i,value:o}))))};var nn=n(3700),rn=n(4436),on=n(5445);const an={[w.Gz.BM]:"До Руху",[w.Gz.EoM]:"По закінченню руху",[w.Gz.MD]:"Під час руху",[w.Gz.Sch]:"По розкладу"},sn=24,ln=({items:e,selectHour:t,selectedHour:n})=>{const o=(0,r.useCallback)((e=>{e.preventDefault(),t(+e.target.value)}),[t]);return r.createElement(rn.Z,{fullWidth:!0},r.createElement(nn.Z,null,"Оберіть годину"),r.createElement(on.Z,{value:n,onChange:o},r.createElement("option",{value:sn},"Online"),Object.entries(e).map((([e,t])=>r.createElement("option",{value:e,key:e},`${e} Hours (${t} photos)`)))))};var cn=n(3031),dn=n(5697),un=n.n(dn),mn=n(8105),hn=n(8252),pn=n(5406),vn=n(3758),fn=n(9826),gn=n(9973),wn=n(9248),yn=n(366),Cn=n(3637),En=n(2692),bn=n(8746),Dn=n(4184),In=n.n(Dn),Zn=n(3450),kn=n(5717),An=n(601),xn=n(7314);const Sn=(e,t)=>(e%t+t)%t,Pn=(0,An.Z)((0,kn.Z)(xn.Z)),Mn=(0,Zn.Z)(Pn);function Tn({children:e,autoplay:t,...n}){const o=(e=>({index:t,key:n})=>r.cloneElement(e[Sn(t,e.length)],{key:n}))(e);return t?r.createElement(Mn,Object.assign({},n,{slideRenderer:o})):r.createElement(Pn,Object.assign({},n,{slideRenderer:o}))}const Rn={root:{"& > *:focus":{outline:"none"}},content:{width:"60%",maxWidth:800,height:"calc(100% - 96px)",maxHeight:700,margin:"-16px auto 0",position:"relative",top:"50%",transform:"translateY(-50%)"},contentMobile:{width:"100%",height:"100%",maxWidth:"initial",maxHeight:"initial",margin:0,top:0,transform:"none","& > $carouselWrapper":{borderRadius:0}},arrow:{width:48,height:48,position:"absolute",top:"calc((100% - 96px) / 2 + 24px)"},arrowLeft:{left:-96},arrowRight:{right:-96},arrowIcon:{color:mn.Z[700]},carouselWrapper:{overflow:"hidden",borderRadius:14,transform:"scale(1.0)",background:"transparent",height:"100%"},dots:{paddingTop:10,margin:"0 auto"},dotsMobile:{paddingTop:0},dotsMobileLandscape:{paddingTop:20},footer:{marginTop:-55,width:"100%",position:"relative",textAlign:"center"},footerMobile:{marginTop:-92},footerMobileLandscape:{marginTop:-3,transform:"translateY(-50vh)",display:"inline-block",width:"auto"},slide:{width:"100%",height:"100%"},slideMobile:{width:"100%",height:"100%"},carousel:{height:"100%"},carouselContainer:{height:"100%"},closed:{position:"absolute",top:0,right:0,zIndex:1500,color:"#fff"},mr:{marginRight:10}};class Gn extends r.Component{constructor(){super(...arguments),this.state={slideIndex:this.props.startIndex||0},this.handleContentClick=e=>e.stopPropagation()||e.preventDefault(),this.handleChange=e=>{this.setState({slideIndex:e},this.onChange(e))},this.decreaseIndex=()=>{const e=Sn(this.state.slideIndex-1,this.props.children.length);this.setState({slideIndex:e},this.onChange(e))}}componentDidUpdate(e,t,n){e.startIndex!==this.props.startIndex&&this.handleChange(this.props.startIndex)}increaseIndex(){const e=Sn(this.state.slideIndex+1,this.props.children.length);this.setState({slideIndex:e},this.onChange(e))}onChange(e){this.props.onChange&&this.props.onChange(Sn(e,this.props.children.length))}render(){const{autoplay:e,children:t,classes:n,containerStyle:o,hideArrows:a,interval:i,landscape:s,mobile:l,ModalProps:c,open:d,onClose:u,onStart:m,onSecondaryAction:h,onAdditionalAction:p}=this.props,v=l&&s,f={enter:pn.duration.enteringScreen,exit:pn.duration.leavingScreen},g=null!=t.length,w=r.createElement(Tn,{autoplay:d&&e&&g,className:n.carousel,containerStyle:{height:"100%",...o},index:this.state.slideIndex,interval:i,onChangeIndex:this.handleChange,slideClassName:n.slide},r.Children.map(t,(e=>r.cloneElement(e,{mobile:l,landscape:v}))));return r.createElement(He.Z,Object.assign({className:In()(n.root,{[n.rootMobile]:l}),open:d,onClose:u,BackdropComponent:En.Z,BackdropProps:c?{transitionDuration:f,...c.BackdropProps}:{transitionDuration:f}},c),r.createElement(Cn.Z,{appear:!0,in:d,timeout:f},r.createElement("div",{className:In()(n.content,{[n.contentMobile]:l}),onClick:this.handleContentClick},r.createElement(re.Z,{elevation:l?0:1,className:n.carouselWrapper},r.createElement(N.Z,{onClick:m,className:n.closed},r.createElement(yn.Z,null)),w),r.createElement("div",{style:v?{minWidth:300,maxWidth:"calc(50% - 48px)",padding:24,float:"right"}:null},r.createElement("div",{className:In()(n.footer,{[n.footerMobile]:l,[n.footerMobileLandscape]:v})},r.createElement(N.Z,{onClick:()=>h(this.state.slideIndex)},r.createElement(Ae.Z,{color:"error"})),r.createElement(N.Z,{onClick:()=>p(this.state.slideIndex)},r.createElement(wn.Z,{color:"primary"})),g&&r.createElement(bn.Z,{count:t.length,index:Sn(this.state.slideIndex,t.length),className:In()(n.dots,{[n.dotsMobile]:l,[n.dotsMobileLandscape]:v}),onDotClick:this.handleChange}))),!l&&!a&&g&&r.createElement("div",null,r.createElement(vn.Z,{className:In()(n.arrow,n.arrowLeft),onClick:()=>this.decreaseIndex()},r.createElement(fn.Z,{className:n.arrowIcon})),r.createElement(vn.Z,{className:In()(n.arrow,n.arrowRight),onClick:()=>this.increaseIndex()},r.createElement(gn.Z,{className:n.arrowIcon}))))))}}Gn.defaultProps={autoplay:!0,interval:3e3,mobile:!1,open:!1,hideArrows:!1},Gn.propTypes={autoplay:un().bool,ButtonProps:un().object,classes:un().object.isRequired,containerStyle:un().object,interval:un().number,label:un().string,landscape:un().bool,mobile:un().bool,ModalProps:un().object,onChange:un().func,onClose:un().func,onStart:un().func,onSecondaryAction:un().func,onAdditionalAction:un().func,open:un().bool,hideArrows:un().bool,startIndex:un().number};var Un=(0,hn.default)(Rn)(Gn),qn=n(3259);const Nn={root:{backgroundColor:qn.default[500],height:"100%"},rootMobileLandscape:{width:"100%",display:"flex",flexDirection:"row"},media:{paddingTop:16,height:"100%",display:"flex",justifyContent:"center",alignItems:"center","& > *":{maxHeight:"100%",maxWidth:"100%"}},mediaMobile:{position:"relative",top:"50%",transform:"translateY(-50%)"},mediaMobileLandscape:{},mediaBackground:{backgroundColor:qn.default[500],height:"calc(100% - 100px)",textAlign:"center"},mediaBackgroundMobile:{height:"calc(100% - 88px)"},mediaBackgroundMobileLandscape:{height:"100%",flex:"1 1",alignSelf:"stretch"},text:{textAlign:"center",maxWidth:"80%",margin:"0 auto",paddingTop:10},textMobile:{paddingTop:30,"& $title":{marginBottom:8}},textMobileLandscape:{minWidth:300,maxWidth:"calc(50% - 48px)",padding:"24px 24px 128px",flex:"0 1",alignSelf:"center",textAlign:"left",margin:0},title:{fontSize:"24px",fontWeight:700,lineHeight:"32px",marginBottom:12,textOverflow:"ellipsis",whiteSpace:"nowrap",overflow:"hidden",color:"#fff"},subtitle:{fontSize:"15px",fontWeight:400,lineHeight:"18px",margin:0,color:"#fff"}};function Bn(e){const{classes:t,media:n,mediaBackgroundStyle:o,subtitle:a,title:i,mobile:s,landscape:l,...c}=e,d=s&&l;return r.createElement("div",Object.assign({className:In()(t.root,{[t.rootMobile]:s,[t.rootMobileLandscape]:d})},c),r.createElement("div",{className:In()(t.mediaBackground,{[t.mediaBackgroundMobile]:s,[t.mediaBackgroundMobileLandscape]:d}),style:o},r.createElement("div",{className:In()(t.media,{[t.mediaMobile]:s,[t.mediaMobileLandscape]:d})},n)),r.createElement("div",{className:In()(t.text,{[t.textMobile]:s,[t.textMobileLandscape]:d})},r.createElement("div",{className:t.title},i),a&&r.createElement(p.Z,{className:t.subtitle},a)))}Bn.propTypes={classes:un().object.isRequired,media:un().node.isRequired,mediaBackgroundStyle:un().object,subtitle:un().string,title:un().element,mobile:un().bool,landscape:un().bool};var Fn=(0,hn.default)(Nn)(Bn);const On=e=>{const t=`${(0,D.b)()}/photos/download/${e}`,n=document.createElement("IFRAME");n.setAttribute("style","display:none;"),n.setAttribute("src",t),n.style.width="0px",n.style.height="0px",document.body.appendChild(n)},jn=(0,D.b)(),$n=(0,f.Z)((e=>(0,me.Z)({photo:{width:({isLast:e})=>e?"unset":148,margin:e.spacing(0,1,1,1),position:"relative"},photoSelect:{display:({editMode:e})=>e?"block":"none",position:"absolute",bottom:e.spacing(3),left:0,backgroundColor:"white!important","&:hover":{backgroundColor:"white!important"}},label:{margin:0}}))),Ln=({photo:e,variant:t})=>r.createElement(be.Z,{display:"flex",justifyContent:"center"},r.createElement(dt.ZP,{title:an[e.source],placement:"left"},r.createElement(p.Z,{variant:t,style:{marginRight:2}},e.source)),r.createElement(p.Z,{variant:t},new Date(+e.originaltime).toLocaleString("uk-UK"))),zn=({photos:e,removePhotoById:t,selected:n,editMode:o,onSelect:a,isLast:i})=>{const s=$n({editMode:o,isLast:i}),[l,c]=(0,r.useState)(null),[d,h]=(0,r.useState)(!1),{setDialogObj:v}=(0,r.useContext)(he),f=(0,it.Z)(),g=(0,at.Z)(f.breakpoints.down("sm")),{isAllowed:w}=jt("removePhoto"),{isAllowed:y}=jt("download"),{redirectToModal:C}=ie(),E=(0,r.useCallback)((t=>{o?a(e[t].id):(h(!0),c(t))}),[a,o]),b=(0,r.useCallback)((n=>{w?v({text:"Видалити фото?",title:"Попередження",isShown:!0,onApprove:()=>{h(!1),t(e[n].id)}}):C("notAllowed")}),[e,w]),D=(0,r.useCallback)((t=>{y?On(e[t].name):C("notAllowed")}),[e,y]);return 0===e.length?r.createElement(p.Z,null,"Немає Фото"):r.createElement(be.Z,{display:"flex",flexWrap:"wrap",justifyContent:"center",alignItems:"center"},e.map(((e,t)=>r.createElement(be.Z,{key:e.id,className:s.photo},r.createElement(u.Z,{control:r.createElement(m.Z,{className:s.photoSelect,checked:n.includes(e.id),onChange:()=>E(t)}),labelPlacement:"top",label:r.createElement("img",{src:`${jn}/photos/preview/${e.name}`,alt:"photo",width:"100%",style:i?{cursor:"pointer",height:"calc(100vh - 26rem)"}:{cursor:"pointer"},loading:"lazy"}),classes:{labelPlacementTop:s.label}}),r.createElement(Ln,{photo:e,variant:"caption"})))),r.createElement(Un,{open:d,label:"Закрити",onClose:()=>h(!1),onStart:()=>h(!1),onSecondaryAction:b,onAdditionalAction:D,autoplay:!1,mobile:g,style:{position:"absolute"},startIndex:l},e.map((e=>r.createElement(Fn,{key:e.id,media:r.createElement("img",{src:`${jn}/photos/preview/${e.name}`,alt:"photo"}),title:r.createElement(Ln,{photo:e,variant:"h5"})})))))},Wn=(0,f.Z)((e=>(0,me.Z)({paper:{padding:e.spacing(2),overflow:"auto"},height:{height:"calc(100vh - 340px)"}}))),Hn=({header:e,timeSelector:t,message:n,body:o,pagination:a})=>{const i=Wn();return r.createElement(z.Z,{container:!0,direction:"column",spacing:1},r.createElement(z.Z,{item:!0,xs:12},e),r.createElement(z.Z,{item:!0,xs:12},t),n&&r.createElement(z.Z,{item:!0,xs:12},n),o&&r.createElement(z.Z,{item:!0,xs:12},r.createElement(re.Z,{className:(0,G.Z)(i.paper,i.height)},o)),a&&r.createElement(z.Z,{item:!0,xs:12},a))},Qn=({filters:e,changeFilters:t,changeEditMode:n,changeSelectAll:o,editMode:a,handleDownload:i,handleRemove:s,selectAll:l})=>{const c=(0,r.useCallback)((n=>{const r=n.target.checked,o=n.target.name;t(r?[...e,o]:e.filter((e=>e!==o)))}),[e]);return r.createElement(be.Z,{display:"flex",flexWrap:"wrap",justifyContent:"space-around"},r.createElement(Me.Z,{row:!0},Object.values(w.Gz).map((t=>r.createElement(u.Z,{key:t,control:r.createElement(m.Z,{checked:e.includes(t),onChange:c,color:"primary"}),name:t,label:an[t]})))),r.createElement(Me.Z,{row:!0},r.createElement(u.Z,{control:r.createElement(m.Z,{checked:a,onChange:e=>{n(e.target.checked)},color:"primary"}),label:"Вибрати"}),r.createElement(u.Z,{control:r.createElement(m.Z,{checked:l,onChange:e=>{o(e.target.checked)},color:"primary",disabled:!a}),label:"Вибрати всі"}),r.createElement(N.Z,{onClick:s,disabled:!a,color:"secondary"},r.createElement(Ae.Z,null)),r.createElement(N.Z,{onClick:i,disabled:!a,color:"primary"},r.createElement(wn.Z,null))))};var Vn=n(2302),Kn=n(9613),_n=n(8222),Yn=n(6847),Jn=n(3750),Xn=n(6498),er=n(9659);const tr=(0,f.Z)({link:{cursor:"pointer"},cellTitle:{paddingLeft:16},linkSelected:{backgroundColor:"lightgray"}}),nr=({items:e,selectHour:t,selectedHour:n})=>{const o=tr(),a=(0,r.useCallback)(((e,n)=>{e.preventDefault(),t(n)}),[t]);return r.createElement(Yn.Z,{component:re.Z},r.createElement(Vn.Z,{size:"small",padding:"none"},r.createElement(Jn.Z,null,r.createElement(Xn.Z,null,r.createElement(_n.Z,{className:o.cellTitle},"Години"),Object.entries(e).map((([e])=>r.createElement(_n.Z,{key:e},e))),r.createElement(_n.Z,null,"Зараз"))),r.createElement(Kn.Z,null,r.createElement(Xn.Z,null,r.createElement(_n.Z,{className:o.cellTitle},"Знимків"),Object.entries(e).map((([e,t])=>r.createElement(_n.Z,{key:e},r.createElement(er.Z,{onClick:t=>a(t,+e),className:(0,G.Z)(o.link,n===+e&&o.linkSelected)},t)))),r.createElement(_n.Z,null,r.createElement(er.Z,{onClick:e=>a(e,sn),className:(0,G.Z)(o.link,n===sn&&o.linkSelected)},"Online"))))))};var rr=n(2222);const or=new Array(24).fill(0).map(((e,t)=>t)).reduce(((e,t)=>({...e,[t]:0})),{}),ar=(0,rr.P1)(_.Ux.selectAll,(e=>{const t={...or};return e.forEach((e=>{const n=new Date(+e.originaltime).getHours();t[n]=t[n]+1})),t})),ir=()=>{const{id:e}=(0,o.UO)(),{setDialogObj:t}=(0,r.useContext)(he),[n,a]=(0,r.useState)(0),[i,s]=(0,r.useState)(""),[l,c]=(0,r.useState)(Date.now()),[d,u]=(0,r.useState)(Object.values(w.Gz)),[m,h]=(0,r.useState)(!1),[v,f]=(0,r.useState)([]),[g,y]=(0,r.useState)(sn),[C,E]=(0,r.useState)(void 0),[b,D]=(0,r.useState)(1),Z=(0,I.I0)(),{getPhotos:k,removePhotoById:A,removePhotosById:x,getLastPhoto:S}=kt(),P=(0,I.v9)(_.Ux.selectAll),M=(0,I.v9)(ar),T=(0,it.Z)(),R=(0,at.Z)(T.breakpoints.up("sm")),G=(0,r.useMemo)((()=>R?nr:ln),[R,nr,ln]),U=(0,r.useMemo)((()=>g===sn&&C?[C]:P.filter((e=>d.includes(e.source))).filter((e=>new Date(+e.originaltime).getHours()===g))),[P,d,g,C]),q=(0,r.useMemo)((()=>U.slice(20*(b-1),20*b)),[U,b]),N=(0,r.useCallback)((async e=>{await A(e),1===U.length&&s("Немає фото за заданий період")}),[A,U]),B=(0,r.useCallback)((async()=>{t({text:"Видалити фото?",title:"Попередження",isShown:!0,onApprove:async()=>{await x(v)}})}),[x,v]),F=(0,r.useCallback)((async()=>{v.forEach((e=>{const t=U.find((t=>t.id===e));t&&On(t.name)}))}),[v,U]),O=(0,r.useCallback)((e=>{f(e?U.map((e=>e.id)):[])}),[U]),j=(0,r.useCallback)((e=>{const t=v.find((t=>t===e));f(t?t=>t.filter((t=>t!==e)):t=>[...t,e])}),[v]),$=(0,r.useCallback)((async t=>{if(e){const n=new Date(t);n.setHours(0),n.setMinutes(0),n.setSeconds(0);const r=new Date(t);r.setHours(23),r.setMinutes(59),r.setSeconds(59),s("Загрузка...");const o=await k(+e,+n,+r);o?(o.length,s("")):s("Помилка. Спробуйте ще раз"),y(sn)}}),[e,k]),L=(0,r.useCallback)(((e,t)=>{D(t)}),[]),z=(0,r.useMemo)((()=>U.length===v.length),[U,v]);return(0,r.useEffect)((()=>{$(l)}),[$,l,e,null==C?void 0:C.id]),(0,r.useEffect)((()=>{clearInterval(n),e&&(S(+e).then(E),a(window.setInterval((()=>{S(+e).then(E)}),5e3)))}),[e]),(0,r.useEffect)((()=>()=>{clearInterval(n)}),[n]),(0,r.useEffect)((()=>{Z(_.qH.actions.photosRemove()),s(""),E(void 0)}),[e]),(0,r.useEffect)((()=>{g===sn&&s(""),D(1)}),[g]),r.createElement(Hn,{header:r.createElement(tn,{onLoad:c}),timeSelector:r.createElement(G,{items:M,selectHour:y,selectedHour:g}),message:i?r.createElement(p.Z,null,i):r.createElement(Qn,{selectAll:z,editMode:m,filters:d,changeFilters:u,changeEditMode:h,changeSelectAll:O,handleRemove:B,handleDownload:F}),body:!i&&r.createElement(zn,{onSelect:j,editMode:m,selected:v,photos:q,removePhotoById:N,isLast:g===sn}),pagination:r.createElement(cn.Z,{count:Math.ceil(U.length/20),variant:"outlined",page:b,onChange:L})})},sr=()=>r.createElement(Ht,null,r.createElement(zt,null),r.createElement(ir,null)),lr=(0,f.Z)((e=>({paper:{position:"absolute",width:e.spacing(80),backgroundColor:e.palette.background.paper,boxShadow:e.shadows[5],padding:e.spacing(4),outline:"none",left:`calc(50% - ${e.spacing(40)}px)`,top:"25%"}})));var cr=()=>{const e=lr(),t=(0,o.k6)(),n=(0,r.useCallback)((()=>{var e;t.go((null===(e=t.location.state)||void 0===e?void 0:e.fromRenderRoutes)?-2:-1)}),[t]);return r.createElement(He.Z,{open:!0},r.createElement(be.Z,{className:e.paper},r.createElement(p.Z,{variant:"h3",gutterBottom:!0},"Недостатньо прав."),r.createElement(p.Z,{variant:"subtitle1",gutterBottom:!0},"Зверніться до власника облікового запису."),r.createElement(be.Z,{marginTop:5},r.createElement(c.Z,{size:"large",color:"primary",variant:"contained",onClick:n},"Повернутися"))))},dr=()=>r.createElement(o.rs,null,r.createElement(o.AW,{path:"/modals/notAllowed",component:cr})),ur=()=>{const{isAdmin:e,isLogged:t}=(()=>{const e=(0,o.k6)(),{isLogged:t,user:n}=J();return"/signin"===e.location.pathname||t||e.push("/signin"),{isLogged:t,user:n,isAdmin:Boolean(null==n?void 0:n.isAdmin)}})();(()=>{const{getUsersPermissions:e}=Oe(),t=(0,I.v9)((e=>e.users.currentUser));(0,r.useEffect)((()=>{t&&e()}),[t])})();const{isModal:n,previousLocation:l,location:c}=ie();return r.createElement(a.Z,{theme:Ee},r.createElement(te,null,r.createElement(s.ZP,null),r.createElement(i.Ix,null),r.createElement(we,null),r.createElement(ve,null,r.createElement(o.rs,{location:n?l:c},r.createElement(o.AW,{path:"/signin",component:R}),r.createElement(fe,{exact:!0,canActive:()=>!1,path:"/",redirectTo:"/devices",component:()=>null}),r.createElement(fe,{canActive:()=>e,path:"/users",redirectTo:"/devices",component:Xe}),r.createElement(fe,{canActive:()=>e,path:"/users/add",redirectTo:"/devices",exact:!0,component:Xe}),r.createElement(fe,{canActive:()=>t,path:"/devices",redirectTo:"/signin",exact:!0,component:sr}),r.createElement(fe,{canActive:()=>t,path:"/devices/:id",redirectTo:"/signin",exact:!0,component:sr}),r.createElement(ae,null)),n?r.createElement(fe,{canActive:()=>t,path:"/modals",component:dr,redirectTo:"/signin"}):null)))}},5659:function(e,t,n){n.d(t,{b:function(){return o},n:function(){return a}});const r="k2.stoer.biz:3000",o=()=>`http://${r}`,a=()=>`ws://${r}`},3513:function(e,t,n){n.d(t,{b7:function(){return a},Me:function(){return i}});var r=n(6403);const o=(0,r.HF)(),a=(0,r.oM)({name:"devices",initialState:o.getInitialState(),reducers:{deviceAdded:o.addOne,devicesReceived:o.setAll,removeDevice:o.removeOne,removeAllDevices:o.removeAll,updateDevice:o.updateOne}}),i=o.getSelectors((e=>e.devices));t.ZP=a.reducer},1221:function(e,t,n){n.d(t,{qH:function(){return a},Ux:function(){return i}});var r=n(6403);const o=(0,r.HF)(),a=(0,r.oM)({name:"photos",initialState:o.getInitialState(),reducers:{photosReceived:o.setAll,photosRemove:o.removeAll,photoRemove:o.removeOne,photoRemoveMany:o.removeMany,photoUpdateOne:o.updateOne}}),i=o.getSelectors((e=>e.photos));t.ZP=a.reducer},8781:function(e,t,n){n.d(t,{lr:function(){return r.l}});var r=n(7503);t.ZP=r.l.reducer},7503:function(e,t,n){n.d(t,{l:function(){return a}});var r=n(6403);const o=(0,r.HF)(),a=(0,r.oM)({name:"users",initialState:o.getInitialState({currentUser:null,error:"",userPermissions:{addDevice:!1,removeDevice:!1,editDevice:!1,download:!1,removePhoto:!1}}),reducers:{userAdded:o.addOne,usersReceived:o.setAll,removeUser:o.removeOne,updateUser:o.updateOne,setCurrentUser(e,t){e.currentUser=t.payload,e.error=""},updateDeviceStatusAdmin(e,t){e.ids.forEach((n=>{var r;const o=(null===(r=e.entities[n])||void 0===r?void 0:r.userGroups.devices.findIndex((e=>e.id===t.payload.id)))||-1;if(-1!==o){const r=e.entities[n];r&&(r.userGroups.devices[o].packet.status=t.payload.status)}}))},updateDeviceActionAdmin(e,t){e.ids.forEach((n=>{var r;const o=(null===(r=e.entities[n])||void 0===r?void 0:r.userGroups.devices.findIndex((e=>e.id===t.payload.id)))||-1;if(-1!==o){const r=e.entities[n];r&&(r.userGroups.devices[o]=t.payload)}}))},addDeviceActionAdmin(e,t){var n;const r=e.ids.find((e=>e===t.payload.userId));r&&(null===(n=e.entities[r])||void 0===n||n.userGroups.devices.push(t.payload.device))},removeDeviceActionAdmin(e,t){const n=e.ids.find((e=>e===t.payload.userId));if(n){const r=e.entities[n];r&&(r.userGroups.devices=r.userGroups.devices.filter((e=>e.id!==t.payload.deviceId)))}},setUserPermissions(e,t){const{userId:n,...r}=t.payload,o=e.entities[n];o&&(o.permission={...o.permission,...r})},setCurrentUserPermissions(e,t){e.userPermissions=t.payload}}});o.getSelectors((e=>e.users))},9901:function(e,t,n){n.d(t,{f3:function(){return r.f},Nn:function(){return r.N}});var r=n(5871);t.ZP=r.N.reducer},5871:function(e,t,n){n.d(t,{N:function(){return a},f:function(){return i}});var r=n(6403);const o=(0,r.HF)(),a=(0,r.oM)({name:"users",initialState:o.getInitialState(),reducers:{userGroupsAdded:o.addOne,usersGroupsReceived:o.setAll,removeUserGroup:o.removeOne,setUserPermissions(e,t){const{userId:n,...r}=t.payload,o=Object.values(e.entities).find((e=>null==e?void 0:e.users.find((e=>e.id===n))));if(o){const e=o.users.find((e=>e.id===n));e&&(e.permission={...e.permission,...r})}},removeUser(e,t){const{userId:n}=t.payload,r=Object.values(e.entities).find((e=>null==e?void 0:e.users.find((e=>e.id===n))));r&&(r.users=r.users.filter((e=>e.id!==n)))}}}),i=o.getSelectors((e=>e.userGroups))},3164:function(e,t,n){var r=n(7294),o=n(3935),a=n(5977),i=n(4751),s=(0,n(71).lX)(),l=n(6403),c=n(4890),d=n(8781),u=n(3513),m=n(1221);const h=(0,l.oM)({name:"server",initialState:{wsConnectionStatus:!0},reducers:{updateWsConnectionStatus:(e,t)=>{e.wsConnectionStatus=t.payload}}}),{updateWsConnectionStatus:p}=h.actions;var v=h.reducer,f=n(9901),g=(0,c.UY)({users:d.ZP,devices:u.ZP,server:v,photos:m.ZP,userGroups:f.ZP}),w=n(5659),y=n(9657);const C=new WebSocket((0,w.n)());const E=(0,l.xC)({reducer:g});var b;b=E.dispatch,C.onopen=function(){console.log("Connected"),b(p(!0)),C.onmessage=function({data:e}){const t=JSON.parse(e),n=(0,y.IG)(t.data,!0);"RECEIVED_SETTINGS"===t.msg&&b(u.b7.actions.updateDevice({id:n.id,changes:{...n}}))}},C.onclose=()=>{b(p(!1))};var D=E;(()=>{const e=n(9933).Z;o.render(r.createElement(i.zt,{store:D},r.createElement(a.F0,{history:s},r.createElement(e,null))),document.getElementById("root"))})()}},t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={id:r,loaded:!1,exports:{}};return e[r](o,o.exports,n),o.loaded=!0,o.exports}n.m=e,n.x=function(){},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,{a:t}),t},n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.hmd=function(e){return(e=Object.create(e)).children||(e.children=[]),Object.defineProperty(e,"exports",{enumerable:!0,set:function(){throw new Error("ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: "+e.id)}}),e},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={143:0},t=[[3164,654]],r=function(){},o=function(o,a){for(var i,s,l=a[0],c=a[1],d=a[2],u=a[3],m=0,h=[];m<l.length;m++)s=l[m],n.o(e,s)&&e[s]&&h.push(e[s][0]),e[s]=0;for(i in c)n.o(c,i)&&(n.m[i]=c[i]);for(d&&d(n),o&&o(a);h.length;)h.shift()();return u&&t.push.apply(t,u),r()},a=self.webpackChunkmvd_ui=self.webpackChunkmvd_ui||[];function i(){for(var r,o=0;o<t.length;o++){for(var a=t[o],i=!0,s=1;s<a.length;s++){var l=a[s];0!==e[l]&&(i=!1)}i&&(t.splice(o--,1),r=n(n.s=a[0]))}return 0===t.length&&(n.x(),n.x=function(){}),r}a.forEach(o.bind(null,0)),a.push=o.bind(null,a.push.bind(a));var s=n.x;n.x=function(){return n.x=s||function(){},(r=i)()}}(),n.x()}();